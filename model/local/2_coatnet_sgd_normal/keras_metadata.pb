
ðÄroot"_tf_keras_network*ÍÄ{"name": "coatnet0", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "must_restore_from_config": false, "class_name": "Functional", "config": {"name": "coatnet0", "layers": [{"class_name": "InputLayer", "config": {"batch_input_shape": {"class_name": "__tuple__", "items": [null, 224, 224, 3]}, "dtype": "float32", "sparse": false, "ragged": false, "name": "input_3"}, "name": "input_3", "inbound_nodes": []}, {"class_name": "ZeroPadding2D", "config": {"name": "stem_1_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stem_1_pad", "inbound_nodes": [[["input_3", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stem_1_conv", "trainable": true, "dtype": "float32", "filters": 64, "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stem_1_conv", "inbound_nodes": [[["stem_1_pad", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stem_1_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stem_1_bn", "inbound_nodes": [[["stem_1_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stem_1_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stem_1_gelu", "inbound_nodes": [[["stem_1_bn", 0, 0, {}]]]}, {"class_name": "ZeroPadding2D", "config": {"name": "stem_2_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stem_2_pad", "inbound_nodes": [[["stem_1_gelu", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stem_2_conv", "trainable": true, "dtype": "float32", "filters": 64, "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stem_2_conv", "inbound_nodes": [[["stem_2_pad", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_1_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_1_preact_bn", "inbound_nodes": [[["stem_2_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_expand_conv", "trainable": true, "dtype": "float32", "filters": 256, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_expand_conv", "inbound_nodes": [[["stack_1_block_1_preact_bn", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_1_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_1_expand_bn", "inbound_nodes": [[["stack_1_block_1_expand_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_1_block_1_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_1_expand_gelu", "inbound_nodes": [[["stack_1_block_1_expand_bn", 0, 0, {}]]]}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_1_block_1_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_1_block_1_MB_dw_pad", "inbound_nodes": [[["stack_1_block_1_expand_gelu", 0, 0, {}]]]}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_1_block_1_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_1_block_1_MB_dw_conv", "inbound_nodes": [[["stack_1_block_1_MB_dw_pad", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_1_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_1_MB_dw_bn", "inbound_nodes": [[["stack_1_block_1_MB_dw_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_1_block_1_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_1_MB_dw_gelu", "inbound_nodes": [[["stack_1_block_1_MB_dw_bn", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean", "inbound_nodes": [["stack_1_block_1_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]]}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_se_1_conv", "trainable": true, "dtype": "float32", "filters": 16, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_1_block_1_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_1_se_gelu", "inbound_nodes": [[["stack_1_block_1_se_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_se_2_conv", "trainable": true, "dtype": "float32", "filters": 256, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_se_2_conv", "inbound_nodes": [[["stack_1_block_1_se_gelu", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_1_block_1_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_1_block_1_se_sigmoid", "inbound_nodes": [[["stack_1_block_1_se_2_conv", 0, 0, {}]]]}, {"class_name": "MaxPooling2D", "config": {"name": "stack_1_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_1_block_1_shortcut_pool", "inbound_nodes": [[["stem_2_conv", 0, 0, {}]]]}, {"class_name": "Multiply", "config": {"name": "stack_1_block_1_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_1_block_1_se_out", "inbound_nodes": [[["stack_1_block_1_MB_dw_gelu", 0, 0, {}], ["stack_1_block_1_se_sigmoid", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 96, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_shortcut_conv", "inbound_nodes": [[["stack_1_block_1_shortcut_pool", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 96, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_MB_pw_conv", "inbound_nodes": [[["stack_1_block_1_se_out", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_1_block_1_output", "trainable": true, "dtype": "float32"}, "name": "stack_1_block_1_output", "inbound_nodes": [[["stack_1_block_1_shortcut_conv", 0, 0, {}], ["stack_1_block_1_MB_pw_conv", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_2_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_2_preact_bn", "inbound_nodes": [[["stack_1_block_1_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_2_expand_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_2_expand_conv", "inbound_nodes": [[["stack_1_block_2_preact_bn", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_2_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_2_expand_bn", "inbound_nodes": [[["stack_1_block_2_expand_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_1_block_2_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_2_expand_gelu", "inbound_nodes": [[["stack_1_block_2_expand_bn", 0, 0, {}]]]}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_1_block_2_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_1_block_2_MB_dw_pad", "inbound_nodes": [[["stack_1_block_2_expand_gelu", 0, 0, {}]]]}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_1_block_2_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_1_block_2_MB_dw_conv", "inbound_nodes": [[["stack_1_block_2_MB_dw_pad", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_2_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_2_MB_dw_bn", "inbound_nodes": [[["stack_1_block_2_MB_dw_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_1_block_2_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_2_MB_dw_gelu", "inbound_nodes": [[["stack_1_block_2_MB_dw_bn", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_1", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean_1", "inbound_nodes": [["stack_1_block_2_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]]}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_2_se_1_conv", "trainable": true, "dtype": "float32", "filters": 24, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_2_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean_1", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_1_block_2_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_2_se_gelu", "inbound_nodes": [[["stack_1_block_2_se_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_2_se_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_2_se_2_conv", "inbound_nodes": [[["stack_1_block_2_se_gelu", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_1_block_2_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_1_block_2_se_sigmoid", "inbound_nodes": [[["stack_1_block_2_se_2_conv", 0, 0, {}]]]}, {"class_name": "Multiply", "config": {"name": "stack_1_block_2_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_1_block_2_se_out", "inbound_nodes": [[["stack_1_block_2_MB_dw_gelu", 0, 0, {}], ["stack_1_block_2_se_sigmoid", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_2_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 96, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_2_MB_pw_conv", "inbound_nodes": [[["stack_1_block_2_se_out", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_1_block_2_output", "trainable": true, "dtype": "float32"}, "name": "stack_1_block_2_output", "inbound_nodes": [[["stack_1_block_1_output", 0, 0, {}], ["stack_1_block_2_MB_pw_conv", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_1_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_1_preact_bn", "inbound_nodes": [[["stack_1_block_2_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_expand_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_expand_conv", "inbound_nodes": [[["stack_2_block_1_preact_bn", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_1_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_1_expand_bn", "inbound_nodes": [[["stack_2_block_1_expand_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_1_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_1_expand_gelu", "inbound_nodes": [[["stack_2_block_1_expand_bn", 0, 0, {}]]]}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_2_block_1_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_2_block_1_MB_dw_pad", "inbound_nodes": [[["stack_2_block_1_expand_gelu", 0, 0, {}]]]}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_2_block_1_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_2_block_1_MB_dw_conv", "inbound_nodes": [[["stack_2_block_1_MB_dw_pad", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_1_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_1_MB_dw_bn", "inbound_nodes": [[["stack_2_block_1_MB_dw_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_1_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_1_MB_dw_gelu", "inbound_nodes": [[["stack_2_block_1_MB_dw_bn", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_2", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean_2", "inbound_nodes": [["stack_2_block_1_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_se_1_conv", "trainable": true, "dtype": "float32", "filters": 24, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean_2", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_1_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_1_se_gelu", "inbound_nodes": [[["stack_2_block_1_se_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_se_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_se_2_conv", "inbound_nodes": [[["stack_2_block_1_se_gelu", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_1_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_2_block_1_se_sigmoid", "inbound_nodes": [[["stack_2_block_1_se_2_conv", 0, 0, {}]]]}, {"class_name": "MaxPooling2D", "config": {"name": "stack_2_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_2_block_1_shortcut_pool", "inbound_nodes": [[["stack_1_block_2_output", 0, 0, {}]]]}, {"class_name": "Multiply", "config": {"name": "stack_2_block_1_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_1_se_out", "inbound_nodes": [[["stack_2_block_1_MB_dw_gelu", 0, 0, {}], ["stack_2_block_1_se_sigmoid", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_shortcut_conv", "inbound_nodes": [[["stack_2_block_1_shortcut_pool", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_MB_pw_conv", "inbound_nodes": [[["stack_2_block_1_se_out", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_2_block_1_output", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_1_output", "inbound_nodes": [[["stack_2_block_1_shortcut_conv", 0, 0, {}], ["stack_2_block_1_MB_pw_conv", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_2_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_2_preact_bn", "inbound_nodes": [[["stack_2_block_1_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_2_expand_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_2_expand_conv", "inbound_nodes": [[["stack_2_block_2_preact_bn", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_2_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_2_expand_bn", "inbound_nodes": [[["stack_2_block_2_expand_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_2_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_2_expand_gelu", "inbound_nodes": [[["stack_2_block_2_expand_bn", 0, 0, {}]]]}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_2_block_2_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_2_block_2_MB_dw_pad", "inbound_nodes": [[["stack_2_block_2_expand_gelu", 0, 0, {}]]]}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_2_block_2_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_2_block_2_MB_dw_conv", "inbound_nodes": [[["stack_2_block_2_MB_dw_pad", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_2_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_2_MB_dw_bn", "inbound_nodes": [[["stack_2_block_2_MB_dw_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_2_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_2_MB_dw_gelu", "inbound_nodes": [[["stack_2_block_2_MB_dw_bn", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_3", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean_3", "inbound_nodes": [["stack_2_block_2_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_2_se_1_conv", "trainable": true, "dtype": "float32", "filters": 48, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_2_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean_3", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_2_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_2_se_gelu", "inbound_nodes": [[["stack_2_block_2_se_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_2_se_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_2_se_2_conv", "inbound_nodes": [[["stack_2_block_2_se_gelu", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_2_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_2_block_2_se_sigmoid", "inbound_nodes": [[["stack_2_block_2_se_2_conv", 0, 0, {}]]]}, {"class_name": "Multiply", "config": {"name": "stack_2_block_2_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_2_se_out", "inbound_nodes": [[["stack_2_block_2_MB_dw_gelu", 0, 0, {}], ["stack_2_block_2_se_sigmoid", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_2_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_2_MB_pw_conv", "inbound_nodes": [[["stack_2_block_2_se_out", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_2_block_2_output", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_2_output", "inbound_nodes": [[["stack_2_block_1_output", 0, 0, {}], ["stack_2_block_2_MB_pw_conv", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_3_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_3_preact_bn", "inbound_nodes": [[["stack_2_block_2_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_3_expand_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_3_expand_conv", "inbound_nodes": [[["stack_2_block_3_preact_bn", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_3_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_3_expand_bn", "inbound_nodes": [[["stack_2_block_3_expand_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_3_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_3_expand_gelu", "inbound_nodes": [[["stack_2_block_3_expand_bn", 0, 0, {}]]]}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_2_block_3_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_2_block_3_MB_dw_pad", "inbound_nodes": [[["stack_2_block_3_expand_gelu", 0, 0, {}]]]}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_2_block_3_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_2_block_3_MB_dw_conv", "inbound_nodes": [[["stack_2_block_3_MB_dw_pad", 0, 0, {}]]]}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_3_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}}, "moving_variance_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_3_MB_dw_bn", "inbound_nodes": [[["stack_2_block_3_MB_dw_conv", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_3_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_3_MB_dw_gelu", "inbound_nodes": [[["stack_2_block_3_MB_dw_bn", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_4", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean_4", "inbound_nodes": [["stack_2_block_3_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_3_se_1_conv", "trainable": true, "dtype": "float32", "filters": 48, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_3_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean_4", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_3_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_3_se_gelu", "inbound_nodes": [[["stack_2_block_3_se_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_3_se_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_3_se_2_conv", "inbound_nodes": [[["stack_2_block_3_se_gelu", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_2_block_3_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_2_block_3_se_sigmoid", "inbound_nodes": [[["stack_2_block_3_se_2_conv", 0, 0, {}]]]}, {"class_name": "Multiply", "config": {"name": "stack_2_block_3_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_3_se_out", "inbound_nodes": [[["stack_2_block_3_MB_dw_gelu", 0, 0, {}], ["stack_2_block_3_se_sigmoid", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_3_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_3_MB_pw_conv", "inbound_nodes": [[["stack_2_block_3_se_out", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_2_block_3_output", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_3_output", "inbound_nodes": [[["stack_2_block_2_output", 0, 0, {}], ["stack_2_block_3_MB_pw_conv", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_1_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_1_preact_ln", "inbound_nodes": [[["stack_2_block_3_output", 0, 0, {}]]]}, {"class_name": "MaxPooling2D", "config": {"name": "stack_3_block_1_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_3_block_1_pool", "inbound_nodes": [[["stack_3_block_1_preact_ln", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_1_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_1_pool", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape", "inbound_nodes": [["stack_3_block_1_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 768]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.split", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split", "inbound_nodes": [["tf.reshape", 0, 0, {"num_or_size_splits": [192, 192, 384], "axis": -1}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_1", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_1", "inbound_nodes": [["tf.split", 0, 0, {"shape": [-1, 196, 6, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_2", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_2", "inbound_nodes": [["tf.split", 0, 1, {"shape": [-1, 196, 6, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose", "inbound_nodes": [["tf.reshape_1", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_1", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_1", "inbound_nodes": [["tf.reshape_2", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda", "inbound_nodes": [[["tf.compat.v1.transpose", 0, 0, {}], ["tf.compat.v1.transpose_1", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply", "inbound_nodes": [["lambda", 0, 0, {"y": 0.1767766922712326, "name": null}]]}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_1_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_1_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_3", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_3", "inbound_nodes": [["tf.split", 0, 2, {"shape": [-1, 196, 6, 64]}]]}, {"class_name": "Softmax", "config": {"name": "stack_3_block_1_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_1_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_1_mhsa_pos_emb", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_2", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_2", "inbound_nodes": [["tf.reshape_3", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_1", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_1", "inbound_nodes": [[["stack_3_block_1_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_2", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_3", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_3", "inbound_nodes": [["lambda_1", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "MaxPooling2D", "config": {"name": "stack_3_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_3_block_1_shortcut_pool", "inbound_nodes": [[["stack_2_block_3_output", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_4", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_4", "inbound_nodes": [["tf.compat.v1.transpose_3", 0, 0, {"shape": [-1, 14, 14, 384]}]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_shortcut_conv", "inbound_nodes": [[["stack_3_block_1_shortcut_pool", 0, 0, {}]]]}, {"class_name": "Dense", "config": {"name": "stack_3_block_1_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_mhsa_output", "inbound_nodes": [[["tf.reshape_4", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_1_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_1_output", "inbound_nodes": [[["stack_3_block_1_shortcut_conv", 0, 0, {}], ["stack_3_block_1_mhsa_output", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_1_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_1_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_1_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_1_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_ffn_1_conv", "inbound_nodes": [[["stack_3_block_1_ffn_preact_ln", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_3_block_1_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_1_ffn_gelu", "inbound_nodes": [[["stack_3_block_1_ffn_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_1_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_ffn_2_conv", "inbound_nodes": [[["stack_3_block_1_ffn_gelu", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_1_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_1_ffn_output", "inbound_nodes": [[["stack_3_block_1_output", 0, 0, {}], ["stack_3_block_1_ffn_2_conv", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_2_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_2_preact_ln", "inbound_nodes": [[["stack_3_block_1_ffn_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_2_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_2_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_2_preact_ln", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_5", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_5", "inbound_nodes": [["stack_3_block_2_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_1", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_1", "inbound_nodes": [["tf.reshape_5", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_6", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_6", "inbound_nodes": [["tf.split_1", 0, 0, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_7", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_7", "inbound_nodes": [["tf.split_1", 0, 1, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_4", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_4", "inbound_nodes": [["tf.reshape_6", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_5", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_5", "inbound_nodes": [["tf.reshape_7", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_2", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_2", "inbound_nodes": [[["tf.compat.v1.transpose_4", 0, 0, {}], ["tf.compat.v1.transpose_5", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_1", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_1", "inbound_nodes": [["lambda_2", 0, 0, {"y": 0.1767766922712326, "name": null}]]}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_2_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_2_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_1", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_8", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_8", "inbound_nodes": [["tf.split_1", 0, 2, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "Softmax", "config": {"name": "stack_3_block_2_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_2_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_2_mhsa_pos_emb", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_6", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_6", "inbound_nodes": [["tf.reshape_8", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_3", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_3", "inbound_nodes": [[["stack_3_block_2_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_6", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_7", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_7", "inbound_nodes": [["lambda_3", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_9", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_9", "inbound_nodes": [["tf.compat.v1.transpose_7", 0, 0, {"shape": [-1, 14, 14, 384]}]]}, {"class_name": "Dense", "config": {"name": "stack_3_block_2_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_2_mhsa_output", "inbound_nodes": [[["tf.reshape_9", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_2_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_2_output", "inbound_nodes": [[["stack_3_block_1_ffn_output", 0, 0, {}], ["stack_3_block_2_mhsa_output", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_2_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_2_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_2_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_2_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_2_ffn_1_conv", "inbound_nodes": [[["stack_3_block_2_ffn_preact_ln", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_3_block_2_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_2_ffn_gelu", "inbound_nodes": [[["stack_3_block_2_ffn_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_2_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_2_ffn_2_conv", "inbound_nodes": [[["stack_3_block_2_ffn_gelu", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_2_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_2_ffn_output", "inbound_nodes": [[["stack_3_block_2_output", 0, 0, {}], ["stack_3_block_2_ffn_2_conv", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_3_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_3_preact_ln", "inbound_nodes": [[["stack_3_block_2_ffn_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_3_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_3_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_3_preact_ln", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_10", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_10", "inbound_nodes": [["stack_3_block_3_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_2", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_2", "inbound_nodes": [["tf.reshape_10", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_11", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_11", "inbound_nodes": [["tf.split_2", 0, 0, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_12", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_12", "inbound_nodes": [["tf.split_2", 0, 1, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_8", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_8", "inbound_nodes": [["tf.reshape_11", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_9", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_9", "inbound_nodes": [["tf.reshape_12", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_4", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_4", "inbound_nodes": [[["tf.compat.v1.transpose_8", 0, 0, {}], ["tf.compat.v1.transpose_9", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_2", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_2", "inbound_nodes": [["lambda_4", 0, 0, {"y": 0.1767766922712326, "name": null}]]}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_3_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_3_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_2", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_13", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_13", "inbound_nodes": [["tf.split_2", 0, 2, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "Softmax", "config": {"name": "stack_3_block_3_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_3_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_3_mhsa_pos_emb", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_10", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_10", "inbound_nodes": [["tf.reshape_13", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_5", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_5", "inbound_nodes": [[["stack_3_block_3_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_10", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_11", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_11", "inbound_nodes": [["lambda_5", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_14", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_14", "inbound_nodes": [["tf.compat.v1.transpose_11", 0, 0, {"shape": [-1, 14, 14, 384]}]]}, {"class_name": "Dense", "config": {"name": "stack_3_block_3_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_3_mhsa_output", "inbound_nodes": [[["tf.reshape_14", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_3_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_3_output", "inbound_nodes": [[["stack_3_block_2_ffn_output", 0, 0, {}], ["stack_3_block_3_mhsa_output", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_3_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_3_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_3_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_3_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_3_ffn_1_conv", "inbound_nodes": [[["stack_3_block_3_ffn_preact_ln", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_3_block_3_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_3_ffn_gelu", "inbound_nodes": [[["stack_3_block_3_ffn_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_3_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_3_ffn_2_conv", "inbound_nodes": [[["stack_3_block_3_ffn_gelu", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_3_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_3_ffn_output", "inbound_nodes": [[["stack_3_block_3_output", 0, 0, {}], ["stack_3_block_3_ffn_2_conv", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_4_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_4_preact_ln", "inbound_nodes": [[["stack_3_block_3_ffn_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_4_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_4_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_4_preact_ln", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_15", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_15", "inbound_nodes": [["stack_3_block_4_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_3", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_3", "inbound_nodes": [["tf.reshape_15", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_16", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_16", "inbound_nodes": [["tf.split_3", 0, 0, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_17", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_17", "inbound_nodes": [["tf.split_3", 0, 1, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_12", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_12", "inbound_nodes": [["tf.reshape_16", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_13", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_13", "inbound_nodes": [["tf.reshape_17", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_6", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_6", "inbound_nodes": [[["tf.compat.v1.transpose_12", 0, 0, {}], ["tf.compat.v1.transpose_13", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_3", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_3", "inbound_nodes": [["lambda_6", 0, 0, {"y": 0.1767766922712326, "name": null}]]}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_4_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_4_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_3", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_18", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_18", "inbound_nodes": [["tf.split_3", 0, 2, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "Softmax", "config": {"name": "stack_3_block_4_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_4_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_4_mhsa_pos_emb", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_14", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_14", "inbound_nodes": [["tf.reshape_18", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_7", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_7", "inbound_nodes": [[["stack_3_block_4_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_14", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_15", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_15", "inbound_nodes": [["lambda_7", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_19", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_19", "inbound_nodes": [["tf.compat.v1.transpose_15", 0, 0, {"shape": [-1, 14, 14, 384]}]]}, {"class_name": "Dense", "config": {"name": "stack_3_block_4_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_4_mhsa_output", "inbound_nodes": [[["tf.reshape_19", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_4_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_4_output", "inbound_nodes": [[["stack_3_block_3_ffn_output", 0, 0, {}], ["stack_3_block_4_mhsa_output", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_4_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_4_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_4_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_4_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_4_ffn_1_conv", "inbound_nodes": [[["stack_3_block_4_ffn_preact_ln", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_3_block_4_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_4_ffn_gelu", "inbound_nodes": [[["stack_3_block_4_ffn_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_4_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_4_ffn_2_conv", "inbound_nodes": [[["stack_3_block_4_ffn_gelu", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_4_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_4_ffn_output", "inbound_nodes": [[["stack_3_block_4_output", 0, 0, {}], ["stack_3_block_4_ffn_2_conv", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_5_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_5_preact_ln", "inbound_nodes": [[["stack_3_block_4_ffn_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_5_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_5_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_5_preact_ln", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_20", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_20", "inbound_nodes": [["stack_3_block_5_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_4", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_4", "inbound_nodes": [["tf.reshape_20", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_21", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_21", "inbound_nodes": [["tf.split_4", 0, 0, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_22", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_22", "inbound_nodes": [["tf.split_4", 0, 1, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_16", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_16", "inbound_nodes": [["tf.reshape_21", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_17", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_17", "inbound_nodes": [["tf.reshape_22", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_8", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_8", "inbound_nodes": [[["tf.compat.v1.transpose_16", 0, 0, {}], ["tf.compat.v1.transpose_17", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_4", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_4", "inbound_nodes": [["lambda_8", 0, 0, {"y": 0.1767766922712326, "name": null}]]}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_5_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_5_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_4", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_23", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_23", "inbound_nodes": [["tf.split_4", 0, 2, {"shape": [-1, 196, 12, 32]}]]}, {"class_name": "Softmax", "config": {"name": "stack_3_block_5_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_5_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_5_mhsa_pos_emb", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_18", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_18", "inbound_nodes": [["tf.reshape_23", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_9", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_9", "inbound_nodes": [[["stack_3_block_5_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_18", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_19", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_19", "inbound_nodes": [["lambda_9", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_24", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_24", "inbound_nodes": [["tf.compat.v1.transpose_19", 0, 0, {"shape": [-1, 14, 14, 384]}]]}, {"class_name": "Dense", "config": {"name": "stack_3_block_5_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_5_mhsa_output", "inbound_nodes": [[["tf.reshape_24", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_5_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_5_output", "inbound_nodes": [[["stack_3_block_4_ffn_output", 0, 0, {}], ["stack_3_block_5_mhsa_output", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_5_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_5_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_5_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_5_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_5_ffn_1_conv", "inbound_nodes": [[["stack_3_block_5_ffn_preact_ln", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_3_block_5_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_5_ffn_gelu", "inbound_nodes": [[["stack_3_block_5_ffn_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_5_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_5_ffn_2_conv", "inbound_nodes": [[["stack_3_block_5_ffn_gelu", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_3_block_5_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_5_ffn_output", "inbound_nodes": [[["stack_3_block_5_output", 0, 0, {}], ["stack_3_block_5_ffn_2_conv", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_4_block_1_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_4_block_1_preact_ln", "inbound_nodes": [[["stack_3_block_5_ffn_output", 0, 0, {}]]]}, {"class_name": "MaxPooling2D", "config": {"name": "stack_4_block_1_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_4_block_1_pool", "inbound_nodes": [[["stack_4_block_1_preact_ln", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_1_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_mhsa_qkv_conv", "inbound_nodes": [[["stack_4_block_1_pool", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_25", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_25", "inbound_nodes": [["stack_4_block_1_mhsa_qkv_conv", 0, 0, {"shape": [-1, 49, 1536]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_5", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_5", "inbound_nodes": [["tf.reshape_25", 0, 0, {"num_or_size_splits": [384, 384, 768], "axis": -1}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_26", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_26", "inbound_nodes": [["tf.split_5", 0, 0, {"shape": [-1, 49, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_27", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_27", "inbound_nodes": [["tf.split_5", 0, 1, {"shape": [-1, 49, 12, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_20", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_20", "inbound_nodes": [["tf.reshape_26", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_21", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_21", "inbound_nodes": [["tf.reshape_27", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_10", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_10", "inbound_nodes": [[["tf.compat.v1.transpose_20", 0, 0, {}], ["tf.compat.v1.transpose_21", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_5", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_5", "inbound_nodes": [["lambda_10", 0, 0, {"y": 0.1767766922712326, "name": null}]]}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_4_block_1_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 7, "num_heads": -1}, "name": "stack_4_block_1_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_5", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_28", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_28", "inbound_nodes": [["tf.split_5", 0, 2, {"shape": [-1, 49, 12, 64]}]]}, {"class_name": "Softmax", "config": {"name": "stack_4_block_1_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_4_block_1_mhsa_attention_scores", "inbound_nodes": [[["stack_4_block_1_mhsa_pos_emb", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_22", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_22", "inbound_nodes": [["tf.reshape_28", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_11", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_11", "inbound_nodes": [[["stack_4_block_1_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_22", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_23", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_23", "inbound_nodes": [["lambda_11", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "MaxPooling2D", "config": {"name": "stack_4_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_4_block_1_shortcut_pool", "inbound_nodes": [[["stack_3_block_5_ffn_output", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_29", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_29", "inbound_nodes": [["tf.compat.v1.transpose_23", 0, 0, {"shape": [-1, 7, 7, 768]}]]}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_shortcut_conv", "inbound_nodes": [[["stack_4_block_1_shortcut_pool", 0, 0, {}]]]}, {"class_name": "Dense", "config": {"name": "stack_4_block_1_mhsa_output", "trainable": true, "dtype": "float32", "units": 768, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_mhsa_output", "inbound_nodes": [[["tf.reshape_29", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_4_block_1_output", "trainable": true, "dtype": "float32"}, "name": "stack_4_block_1_output", "inbound_nodes": [[["stack_4_block_1_shortcut_conv", 0, 0, {}], ["stack_4_block_1_mhsa_output", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_4_block_1_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_4_block_1_ffn_preact_ln", "inbound_nodes": [[["stack_4_block_1_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_1_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 3072, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_ffn_1_conv", "inbound_nodes": [[["stack_4_block_1_ffn_preact_ln", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_4_block_1_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_4_block_1_ffn_gelu", "inbound_nodes": [[["stack_4_block_1_ffn_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_1_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_ffn_2_conv", "inbound_nodes": [[["stack_4_block_1_ffn_gelu", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_4_block_1_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_4_block_1_ffn_output", "inbound_nodes": [[["stack_4_block_1_output", 0, 0, {}], ["stack_4_block_1_ffn_2_conv", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_4_block_2_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_4_block_2_preact_ln", "inbound_nodes": [[["stack_4_block_1_ffn_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_2_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 2304, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_2_mhsa_qkv_conv", "inbound_nodes": [[["stack_4_block_2_preact_ln", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_30", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_30", "inbound_nodes": [["stack_4_block_2_mhsa_qkv_conv", 0, 0, {"shape": [-1, 49, 2304]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_6", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_6", "inbound_nodes": [["tf.reshape_30", 0, 0, {"num_or_size_splits": [768, 768, 768], "axis": -1}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_31", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_31", "inbound_nodes": [["tf.split_6", 0, 0, {"shape": [-1, 49, 24, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_32", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_32", "inbound_nodes": [["tf.split_6", 0, 1, {"shape": [-1, 49, 24, 32]}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_24", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_24", "inbound_nodes": [["tf.reshape_31", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_25", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_25", "inbound_nodes": [["tf.reshape_32", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_12", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_12", "inbound_nodes": [[["tf.compat.v1.transpose_24", 0, 0, {}], ["tf.compat.v1.transpose_25", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_6", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_6", "inbound_nodes": [["lambda_12", 0, 0, {"y": 0.1767766922712326, "name": null}]]}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_4_block_2_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 7, "num_heads": -1}, "name": "stack_4_block_2_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_6", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_33", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_33", "inbound_nodes": [["tf.split_6", 0, 2, {"shape": [-1, 49, 24, 32]}]]}, {"class_name": "Softmax", "config": {"name": "stack_4_block_2_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_4_block_2_mhsa_attention_scores", "inbound_nodes": [[["stack_4_block_2_mhsa_pos_emb", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_26", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_26", "inbound_nodes": [["tf.reshape_33", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "Lambda", "config": {"name": "lambda_13", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_13", "inbound_nodes": [[["stack_4_block_2_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_26", 0, 0, {}]]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_27", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_27", "inbound_nodes": [["lambda_13", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]]}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_34", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_34", "inbound_nodes": [["tf.compat.v1.transpose_27", 0, 0, {"shape": [-1, 7, 7, 768]}]]}, {"class_name": "Dense", "config": {"name": "stack_4_block_2_mhsa_output", "trainable": true, "dtype": "float32", "units": 768, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_2_mhsa_output", "inbound_nodes": [[["tf.reshape_34", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_4_block_2_output", "trainable": true, "dtype": "float32"}, "name": "stack_4_block_2_output", "inbound_nodes": [[["stack_4_block_1_ffn_output", 0, 0, {}], ["stack_4_block_2_mhsa_output", 0, 0, {}]]]}, {"class_name": "LayerNormalization", "config": {"name": "stack_4_block_2_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}}, "gamma_initializer": {"class_name": "Ones", "config": {}}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_4_block_2_ffn_preact_ln", "inbound_nodes": [[["stack_4_block_2_output", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_2_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 3072, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_2_ffn_1_conv", "inbound_nodes": [[["stack_4_block_2_ffn_preact_ln", 0, 0, {}]]]}, {"class_name": "Activation", "config": {"name": "stack_4_block_2_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_4_block_2_ffn_gelu", "inbound_nodes": [[["stack_4_block_2_ffn_1_conv", 0, 0, {}]]]}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_2_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_2_ffn_2_conv", "inbound_nodes": [[["stack_4_block_2_ffn_gelu", 0, 0, {}]]]}, {"class_name": "Add", "config": {"name": "stack_4_block_2_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_4_block_2_ffn_output", "inbound_nodes": [[["stack_4_block_2_output", 0, 0, {}], ["stack_4_block_2_ffn_2_conv", 0, 0, {}]]]}, {"class_name": "GlobalAveragePooling2D", "config": {"name": "avg_pool", "trainable": true, "dtype": "float32", "data_format": "channels_last", "keepdims": false}, "name": "avg_pool", "inbound_nodes": [[["stack_4_block_2_ffn_output", 0, 0, {}]]]}, {"class_name": "Dense", "config": {"name": "predictions", "trainable": true, "dtype": "float32", "units": 11, "activation": "softmax", "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}}, "bias_initializer": {"class_name": "Zeros", "config": {}}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "predictions", "inbound_nodes": [[["avg_pool", 0, 0, {}]]]}], "input_layers": [["input_3", 0, 0]], "output_layers": [["predictions", 0, 0]]}, "shared_object_id": 433, "input_spec": [{"class_name": "InputSpec", "config": {"dtype": null, "shape": {"class_name": "__tuple__", "items": [null, 224, 224, 3]}, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}}], "build_input_shape": {"class_name": "TensorShape", "items": [null, 224, 224, 3]}, "is_graph_network": true, "full_save_spec": {"class_name": "__tuple__", "items": [[{"class_name": "TypeSpec", "type_spec": "tf.TensorSpec", "serialized": [{"class_name": "TensorShape", "items": [null, 224, 224, 3]}, "float32", "input_3"]}], {}]}, "save_spec": {"class_name": "TypeSpec", "type_spec": "tf.TensorSpec", "serialized": [{"class_name": "TensorShape", "items": [null, 224, 224, 3]}, "float32", "input_3"]}, "keras_version": "2.9.0", "backend": "tensorflow", "model_config": {"class_name": "Functional", "config": {"name": "coatnet0", "layers": [{"class_name": "InputLayer", "config": {"batch_input_shape": {"class_name": "__tuple__", "items": [null, 224, 224, 3]}, "dtype": "float32", "sparse": false, "ragged": false, "name": "input_3"}, "name": "input_3", "inbound_nodes": [], "shared_object_id": 0}, {"class_name": "ZeroPadding2D", "config": {"name": "stem_1_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stem_1_pad", "inbound_nodes": [[["input_3", 0, 0, {}]]], "shared_object_id": 1}, {"class_name": "Conv2D", "config": {"name": "stem_1_conv", "trainable": true, "dtype": "float32", "filters": 64, "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 3}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stem_1_conv", "inbound_nodes": [[["stem_1_pad", 0, 0, {}]]], "shared_object_id": 4}, {"class_name": "BatchNormalization", "config": {"name": "stem_1_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 5}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 6}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 7}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 8}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stem_1_bn", "inbound_nodes": [[["stem_1_conv", 0, 0, {}]]], "shared_object_id": 9}, {"class_name": "Activation", "config": {"name": "stem_1_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stem_1_gelu", "inbound_nodes": [[["stem_1_bn", 0, 0, {}]]], "shared_object_id": 10}, {"class_name": "ZeroPadding2D", "config": {"name": "stem_2_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stem_2_pad", "inbound_nodes": [[["stem_1_gelu", 0, 0, {}]]], "shared_object_id": 11}, {"class_name": "Conv2D", "config": {"name": "stem_2_conv", "trainable": true, "dtype": "float32", "filters": 64, "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 12}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stem_2_conv", "inbound_nodes": [[["stem_2_pad", 0, 0, {}]]], "shared_object_id": 13}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_1_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 14}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 15}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 16}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 17}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_1_preact_bn", "inbound_nodes": [[["stem_2_conv", 0, 0, {}]]], "shared_object_id": 18}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_expand_conv", "trainable": true, "dtype": "float32", "filters": 256, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 19}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_expand_conv", "inbound_nodes": [[["stack_1_block_1_preact_bn", 0, 0, {}]]], "shared_object_id": 20}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_1_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 21}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 22}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 23}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 24}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_1_expand_bn", "inbound_nodes": [[["stack_1_block_1_expand_conv", 0, 0, {}]]], "shared_object_id": 25}, {"class_name": "Activation", "config": {"name": "stack_1_block_1_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_1_expand_gelu", "inbound_nodes": [[["stack_1_block_1_expand_bn", 0, 0, {}]]], "shared_object_id": 26}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_1_block_1_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_1_block_1_MB_dw_pad", "inbound_nodes": [[["stack_1_block_1_expand_gelu", 0, 0, {}]]], "shared_object_id": 27}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_1_block_1_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 28}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 29}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_1_block_1_MB_dw_conv", "inbound_nodes": [[["stack_1_block_1_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 30}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_1_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 31}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 32}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 33}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 34}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_1_MB_dw_bn", "inbound_nodes": [[["stack_1_block_1_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 35}, {"class_name": "Activation", "config": {"name": "stack_1_block_1_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_1_MB_dw_gelu", "inbound_nodes": [[["stack_1_block_1_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 36}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean", "inbound_nodes": [["stack_1_block_1_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 37}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_se_1_conv", "trainable": true, "dtype": "float32", "filters": 16, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 38}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean", 0, 0, {}]]], "shared_object_id": 39}, {"class_name": "Activation", "config": {"name": "stack_1_block_1_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_1_se_gelu", "inbound_nodes": [[["stack_1_block_1_se_1_conv", 0, 0, {}]]], "shared_object_id": 40}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_se_2_conv", "trainable": true, "dtype": "float32", "filters": 256, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 41}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_se_2_conv", "inbound_nodes": [[["stack_1_block_1_se_gelu", 0, 0, {}]]], "shared_object_id": 42}, {"class_name": "Activation", "config": {"name": "stack_1_block_1_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_1_block_1_se_sigmoid", "inbound_nodes": [[["stack_1_block_1_se_2_conv", 0, 0, {}]]], "shared_object_id": 43}, {"class_name": "MaxPooling2D", "config": {"name": "stack_1_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_1_block_1_shortcut_pool", "inbound_nodes": [[["stem_2_conv", 0, 0, {}]]], "shared_object_id": 44}, {"class_name": "Multiply", "config": {"name": "stack_1_block_1_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_1_block_1_se_out", "inbound_nodes": [[["stack_1_block_1_MB_dw_gelu", 0, 0, {}], ["stack_1_block_1_se_sigmoid", 0, 0, {}]]], "shared_object_id": 45}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 96, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 46}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_shortcut_conv", "inbound_nodes": [[["stack_1_block_1_shortcut_pool", 0, 0, {}]]], "shared_object_id": 47}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_1_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 96, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 48}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_1_MB_pw_conv", "inbound_nodes": [[["stack_1_block_1_se_out", 0, 0, {}]]], "shared_object_id": 49}, {"class_name": "Add", "config": {"name": "stack_1_block_1_output", "trainable": true, "dtype": "float32"}, "name": "stack_1_block_1_output", "inbound_nodes": [[["stack_1_block_1_shortcut_conv", 0, 0, {}], ["stack_1_block_1_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 50}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_2_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 51}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 52}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 53}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 54}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_2_preact_bn", "inbound_nodes": [[["stack_1_block_1_output", 0, 0, {}]]], "shared_object_id": 55}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_2_expand_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 56}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_2_expand_conv", "inbound_nodes": [[["stack_1_block_2_preact_bn", 0, 0, {}]]], "shared_object_id": 57}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_2_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 58}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 59}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 60}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 61}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_2_expand_bn", "inbound_nodes": [[["stack_1_block_2_expand_conv", 0, 0, {}]]], "shared_object_id": 62}, {"class_name": "Activation", "config": {"name": "stack_1_block_2_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_2_expand_gelu", "inbound_nodes": [[["stack_1_block_2_expand_bn", 0, 0, {}]]], "shared_object_id": 63}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_1_block_2_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_1_block_2_MB_dw_pad", "inbound_nodes": [[["stack_1_block_2_expand_gelu", 0, 0, {}]]], "shared_object_id": 64}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_1_block_2_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 65}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 66}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_1_block_2_MB_dw_conv", "inbound_nodes": [[["stack_1_block_2_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 67}, {"class_name": "BatchNormalization", "config": {"name": "stack_1_block_2_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 68}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 69}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 70}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 71}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_1_block_2_MB_dw_bn", "inbound_nodes": [[["stack_1_block_2_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 72}, {"class_name": "Activation", "config": {"name": "stack_1_block_2_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_2_MB_dw_gelu", "inbound_nodes": [[["stack_1_block_2_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 73}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_1", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean_1", "inbound_nodes": [["stack_1_block_2_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 74}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_2_se_1_conv", "trainable": true, "dtype": "float32", "filters": 24, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 75}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_2_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean_1", 0, 0, {}]]], "shared_object_id": 76}, {"class_name": "Activation", "config": {"name": "stack_1_block_2_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_1_block_2_se_gelu", "inbound_nodes": [[["stack_1_block_2_se_1_conv", 0, 0, {}]]], "shared_object_id": 77}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_2_se_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 78}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_2_se_2_conv", "inbound_nodes": [[["stack_1_block_2_se_gelu", 0, 0, {}]]], "shared_object_id": 79}, {"class_name": "Activation", "config": {"name": "stack_1_block_2_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_1_block_2_se_sigmoid", "inbound_nodes": [[["stack_1_block_2_se_2_conv", 0, 0, {}]]], "shared_object_id": 80}, {"class_name": "Multiply", "config": {"name": "stack_1_block_2_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_1_block_2_se_out", "inbound_nodes": [[["stack_1_block_2_MB_dw_gelu", 0, 0, {}], ["stack_1_block_2_se_sigmoid", 0, 0, {}]]], "shared_object_id": 81}, {"class_name": "Conv2D", "config": {"name": "stack_1_block_2_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 96, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 82}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_1_block_2_MB_pw_conv", "inbound_nodes": [[["stack_1_block_2_se_out", 0, 0, {}]]], "shared_object_id": 83}, {"class_name": "Add", "config": {"name": "stack_1_block_2_output", "trainable": true, "dtype": "float32"}, "name": "stack_1_block_2_output", "inbound_nodes": [[["stack_1_block_1_output", 0, 0, {}], ["stack_1_block_2_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 84}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_1_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 85}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 86}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 87}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 88}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_1_preact_bn", "inbound_nodes": [[["stack_1_block_2_output", 0, 0, {}]]], "shared_object_id": 89}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_expand_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 90}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_expand_conv", "inbound_nodes": [[["stack_2_block_1_preact_bn", 0, 0, {}]]], "shared_object_id": 91}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_1_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 92}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 93}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 94}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 95}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_1_expand_bn", "inbound_nodes": [[["stack_2_block_1_expand_conv", 0, 0, {}]]], "shared_object_id": 96}, {"class_name": "Activation", "config": {"name": "stack_2_block_1_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_1_expand_gelu", "inbound_nodes": [[["stack_2_block_1_expand_bn", 0, 0, {}]]], "shared_object_id": 97}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_2_block_1_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_2_block_1_MB_dw_pad", "inbound_nodes": [[["stack_2_block_1_expand_gelu", 0, 0, {}]]], "shared_object_id": 98}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_2_block_1_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 99}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 100}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_2_block_1_MB_dw_conv", "inbound_nodes": [[["stack_2_block_1_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 101}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_1_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 102}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 103}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 104}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 105}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_1_MB_dw_bn", "inbound_nodes": [[["stack_2_block_1_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 106}, {"class_name": "Activation", "config": {"name": "stack_2_block_1_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_1_MB_dw_gelu", "inbound_nodes": [[["stack_2_block_1_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 107}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_2", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean_2", "inbound_nodes": [["stack_2_block_1_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 108}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_se_1_conv", "trainable": true, "dtype": "float32", "filters": 24, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 109}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean_2", 0, 0, {}]]], "shared_object_id": 110}, {"class_name": "Activation", "config": {"name": "stack_2_block_1_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_1_se_gelu", "inbound_nodes": [[["stack_2_block_1_se_1_conv", 0, 0, {}]]], "shared_object_id": 111}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_se_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 112}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_se_2_conv", "inbound_nodes": [[["stack_2_block_1_se_gelu", 0, 0, {}]]], "shared_object_id": 113}, {"class_name": "Activation", "config": {"name": "stack_2_block_1_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_2_block_1_se_sigmoid", "inbound_nodes": [[["stack_2_block_1_se_2_conv", 0, 0, {}]]], "shared_object_id": 114}, {"class_name": "MaxPooling2D", "config": {"name": "stack_2_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_2_block_1_shortcut_pool", "inbound_nodes": [[["stack_1_block_2_output", 0, 0, {}]]], "shared_object_id": 115}, {"class_name": "Multiply", "config": {"name": "stack_2_block_1_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_1_se_out", "inbound_nodes": [[["stack_2_block_1_MB_dw_gelu", 0, 0, {}], ["stack_2_block_1_se_sigmoid", 0, 0, {}]]], "shared_object_id": 116}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 117}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_shortcut_conv", "inbound_nodes": [[["stack_2_block_1_shortcut_pool", 0, 0, {}]]], "shared_object_id": 118}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_1_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 119}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_1_MB_pw_conv", "inbound_nodes": [[["stack_2_block_1_se_out", 0, 0, {}]]], "shared_object_id": 120}, {"class_name": "Add", "config": {"name": "stack_2_block_1_output", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_1_output", "inbound_nodes": [[["stack_2_block_1_shortcut_conv", 0, 0, {}], ["stack_2_block_1_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 121}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_2_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 122}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 123}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 124}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 125}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_2_preact_bn", "inbound_nodes": [[["stack_2_block_1_output", 0, 0, {}]]], "shared_object_id": 126}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_2_expand_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 127}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_2_expand_conv", "inbound_nodes": [[["stack_2_block_2_preact_bn", 0, 0, {}]]], "shared_object_id": 128}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_2_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 129}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 130}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 131}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 132}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_2_expand_bn", "inbound_nodes": [[["stack_2_block_2_expand_conv", 0, 0, {}]]], "shared_object_id": 133}, {"class_name": "Activation", "config": {"name": "stack_2_block_2_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_2_expand_gelu", "inbound_nodes": [[["stack_2_block_2_expand_bn", 0, 0, {}]]], "shared_object_id": 134}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_2_block_2_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_2_block_2_MB_dw_pad", "inbound_nodes": [[["stack_2_block_2_expand_gelu", 0, 0, {}]]], "shared_object_id": 135}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_2_block_2_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 136}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 137}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_2_block_2_MB_dw_conv", "inbound_nodes": [[["stack_2_block_2_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 138}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_2_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 139}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 140}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 141}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 142}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_2_MB_dw_bn", "inbound_nodes": [[["stack_2_block_2_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 143}, {"class_name": "Activation", "config": {"name": "stack_2_block_2_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_2_MB_dw_gelu", "inbound_nodes": [[["stack_2_block_2_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 144}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_3", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean_3", "inbound_nodes": [["stack_2_block_2_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 145}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_2_se_1_conv", "trainable": true, "dtype": "float32", "filters": 48, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 146}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_2_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean_3", 0, 0, {}]]], "shared_object_id": 147}, {"class_name": "Activation", "config": {"name": "stack_2_block_2_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_2_se_gelu", "inbound_nodes": [[["stack_2_block_2_se_1_conv", 0, 0, {}]]], "shared_object_id": 148}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_2_se_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 149}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_2_se_2_conv", "inbound_nodes": [[["stack_2_block_2_se_gelu", 0, 0, {}]]], "shared_object_id": 150}, {"class_name": "Activation", "config": {"name": "stack_2_block_2_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_2_block_2_se_sigmoid", "inbound_nodes": [[["stack_2_block_2_se_2_conv", 0, 0, {}]]], "shared_object_id": 151}, {"class_name": "Multiply", "config": {"name": "stack_2_block_2_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_2_se_out", "inbound_nodes": [[["stack_2_block_2_MB_dw_gelu", 0, 0, {}], ["stack_2_block_2_se_sigmoid", 0, 0, {}]]], "shared_object_id": 152}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_2_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 153}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_2_MB_pw_conv", "inbound_nodes": [[["stack_2_block_2_se_out", 0, 0, {}]]], "shared_object_id": 154}, {"class_name": "Add", "config": {"name": "stack_2_block_2_output", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_2_output", "inbound_nodes": [[["stack_2_block_1_output", 0, 0, {}], ["stack_2_block_2_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 155}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_3_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 156}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 157}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 158}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 159}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_3_preact_bn", "inbound_nodes": [[["stack_2_block_2_output", 0, 0, {}]]], "shared_object_id": 160}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_3_expand_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 161}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_3_expand_conv", "inbound_nodes": [[["stack_2_block_3_preact_bn", 0, 0, {}]]], "shared_object_id": 162}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_3_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 163}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 164}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 165}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 166}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_3_expand_bn", "inbound_nodes": [[["stack_2_block_3_expand_conv", 0, 0, {}]]], "shared_object_id": 167}, {"class_name": "Activation", "config": {"name": "stack_2_block_3_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_3_expand_gelu", "inbound_nodes": [[["stack_2_block_3_expand_bn", 0, 0, {}]]], "shared_object_id": 168}, {"class_name": "ZeroPadding2D", "config": {"name": "stack_2_block_3_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "name": "stack_2_block_3_MB_dw_pad", "inbound_nodes": [[["stack_2_block_3_expand_gelu", 0, 0, {}]]], "shared_object_id": 169}, {"class_name": "DepthwiseConv2D", "config": {"name": "stack_2_block_3_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 170}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 171}, "depthwise_regularizer": null, "depthwise_constraint": null}, "name": "stack_2_block_3_MB_dw_conv", "inbound_nodes": [[["stack_2_block_3_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 172}, {"class_name": "BatchNormalization", "config": {"name": "stack_2_block_3_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 173}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 174}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 175}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 176}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_2_block_3_MB_dw_bn", "inbound_nodes": [[["stack_2_block_3_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 177}, {"class_name": "Activation", "config": {"name": "stack_2_block_3_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_3_MB_dw_gelu", "inbound_nodes": [[["stack_2_block_3_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 178}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_4", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "name": "tf.math.reduce_mean_4", "inbound_nodes": [["stack_2_block_3_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 179}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_3_se_1_conv", "trainable": true, "dtype": "float32", "filters": 48, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 180}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_3_se_1_conv", "inbound_nodes": [[["tf.math.reduce_mean_4", 0, 0, {}]]], "shared_object_id": 181}, {"class_name": "Activation", "config": {"name": "stack_2_block_3_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_2_block_3_se_gelu", "inbound_nodes": [[["stack_2_block_3_se_1_conv", 0, 0, {}]]], "shared_object_id": 182}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_3_se_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 183}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_3_se_2_conv", "inbound_nodes": [[["stack_2_block_3_se_gelu", 0, 0, {}]]], "shared_object_id": 184}, {"class_name": "Activation", "config": {"name": "stack_2_block_3_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "name": "stack_2_block_3_se_sigmoid", "inbound_nodes": [[["stack_2_block_3_se_2_conv", 0, 0, {}]]], "shared_object_id": 185}, {"class_name": "Multiply", "config": {"name": "stack_2_block_3_se_out", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_3_se_out", "inbound_nodes": [[["stack_2_block_3_MB_dw_gelu", 0, 0, {}], ["stack_2_block_3_se_sigmoid", 0, 0, {}]]], "shared_object_id": 186}, {"class_name": "Conv2D", "config": {"name": "stack_2_block_3_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 187}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_2_block_3_MB_pw_conv", "inbound_nodes": [[["stack_2_block_3_se_out", 0, 0, {}]]], "shared_object_id": 188}, {"class_name": "Add", "config": {"name": "stack_2_block_3_output", "trainable": true, "dtype": "float32"}, "name": "stack_2_block_3_output", "inbound_nodes": [[["stack_2_block_2_output", 0, 0, {}], ["stack_2_block_3_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 189}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_1_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 190}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 191}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_1_preact_ln", "inbound_nodes": [[["stack_2_block_3_output", 0, 0, {}]]], "shared_object_id": 192}, {"class_name": "MaxPooling2D", "config": {"name": "stack_3_block_1_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_3_block_1_pool", "inbound_nodes": [[["stack_3_block_1_preact_ln", 0, 0, {}]]], "shared_object_id": 193}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_1_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 194}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_1_pool", 0, 0, {}]]], "shared_object_id": 195}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape", "inbound_nodes": [["stack_3_block_1_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 768]}]], "shared_object_id": 196}, {"class_name": "TFOpLambda", "config": {"name": "tf.split", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split", "inbound_nodes": [["tf.reshape", 0, 0, {"num_or_size_splits": [192, 192, 384], "axis": -1}]], "shared_object_id": 197}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_1", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_1", "inbound_nodes": [["tf.split", 0, 0, {"shape": [-1, 196, 6, 32]}]], "shared_object_id": 198}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_2", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_2", "inbound_nodes": [["tf.split", 0, 1, {"shape": [-1, 196, 6, 32]}]], "shared_object_id": 199}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose", "inbound_nodes": [["tf.reshape_1", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 200}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_1", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_1", "inbound_nodes": [["tf.reshape_2", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 201}, {"class_name": "Lambda", "config": {"name": "lambda", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda", "inbound_nodes": [[["tf.compat.v1.transpose", 0, 0, {}], ["tf.compat.v1.transpose_1", 0, 0, {}]]], "shared_object_id": 202}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply", "inbound_nodes": [["lambda", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 203}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_1_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_1_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply", 0, 0, {}]]], "shared_object_id": 204}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_3", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_3", "inbound_nodes": [["tf.split", 0, 2, {"shape": [-1, 196, 6, 64]}]], "shared_object_id": 205}, {"class_name": "Softmax", "config": {"name": "stack_3_block_1_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_1_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_1_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 206}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_2", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_2", "inbound_nodes": [["tf.reshape_3", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 207}, {"class_name": "Lambda", "config": {"name": "lambda_1", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_1", "inbound_nodes": [[["stack_3_block_1_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_2", 0, 0, {}]]], "shared_object_id": 208}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_3", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_3", "inbound_nodes": [["lambda_1", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 209}, {"class_name": "MaxPooling2D", "config": {"name": "stack_3_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_3_block_1_shortcut_pool", "inbound_nodes": [[["stack_2_block_3_output", 0, 0, {}]]], "shared_object_id": 210}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_4", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_4", "inbound_nodes": [["tf.compat.v1.transpose_3", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 211}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 212}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_shortcut_conv", "inbound_nodes": [[["stack_3_block_1_shortcut_pool", 0, 0, {}]]], "shared_object_id": 213}, {"class_name": "Dense", "config": {"name": "stack_3_block_1_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 214}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 215}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_mhsa_output", "inbound_nodes": [[["tf.reshape_4", 0, 0, {}]]], "shared_object_id": 216}, {"class_name": "Add", "config": {"name": "stack_3_block_1_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_1_output", "inbound_nodes": [[["stack_3_block_1_shortcut_conv", 0, 0, {}], ["stack_3_block_1_mhsa_output", 0, 0, {}]]], "shared_object_id": 217}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_1_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 218}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 219}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_1_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_1_output", 0, 0, {}]]], "shared_object_id": 220}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_1_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 221}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_ffn_1_conv", "inbound_nodes": [[["stack_3_block_1_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 222}, {"class_name": "Activation", "config": {"name": "stack_3_block_1_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_1_ffn_gelu", "inbound_nodes": [[["stack_3_block_1_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 223}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_1_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 224}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_1_ffn_2_conv", "inbound_nodes": [[["stack_3_block_1_ffn_gelu", 0, 0, {}]]], "shared_object_id": 225}, {"class_name": "Add", "config": {"name": "stack_3_block_1_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_1_ffn_output", "inbound_nodes": [[["stack_3_block_1_output", 0, 0, {}], ["stack_3_block_1_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 226}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_2_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 227}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 228}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_2_preact_ln", "inbound_nodes": [[["stack_3_block_1_ffn_output", 0, 0, {}]]], "shared_object_id": 229}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_2_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 230}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_2_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_2_preact_ln", 0, 0, {}]]], "shared_object_id": 231}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_5", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_5", "inbound_nodes": [["stack_3_block_2_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]], "shared_object_id": 232}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_1", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_1", "inbound_nodes": [["tf.reshape_5", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]], "shared_object_id": 233}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_6", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_6", "inbound_nodes": [["tf.split_1", 0, 0, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 234}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_7", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_7", "inbound_nodes": [["tf.split_1", 0, 1, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 235}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_4", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_4", "inbound_nodes": [["tf.reshape_6", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 236}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_5", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_5", "inbound_nodes": [["tf.reshape_7", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 237}, {"class_name": "Lambda", "config": {"name": "lambda_2", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_2", "inbound_nodes": [[["tf.compat.v1.transpose_4", 0, 0, {}], ["tf.compat.v1.transpose_5", 0, 0, {}]]], "shared_object_id": 238}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_1", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_1", "inbound_nodes": [["lambda_2", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 239}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_2_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_2_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_1", 0, 0, {}]]], "shared_object_id": 240}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_8", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_8", "inbound_nodes": [["tf.split_1", 0, 2, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 241}, {"class_name": "Softmax", "config": {"name": "stack_3_block_2_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_2_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_2_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 242}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_6", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_6", "inbound_nodes": [["tf.reshape_8", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 243}, {"class_name": "Lambda", "config": {"name": "lambda_3", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_3", "inbound_nodes": [[["stack_3_block_2_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_6", 0, 0, {}]]], "shared_object_id": 244}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_7", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_7", "inbound_nodes": [["lambda_3", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 245}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_9", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_9", "inbound_nodes": [["tf.compat.v1.transpose_7", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 246}, {"class_name": "Dense", "config": {"name": "stack_3_block_2_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 247}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 248}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_2_mhsa_output", "inbound_nodes": [[["tf.reshape_9", 0, 0, {}]]], "shared_object_id": 249}, {"class_name": "Add", "config": {"name": "stack_3_block_2_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_2_output", "inbound_nodes": [[["stack_3_block_1_ffn_output", 0, 0, {}], ["stack_3_block_2_mhsa_output", 0, 0, {}]]], "shared_object_id": 250}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_2_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 251}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 252}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_2_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_2_output", 0, 0, {}]]], "shared_object_id": 253}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_2_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 254}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_2_ffn_1_conv", "inbound_nodes": [[["stack_3_block_2_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 255}, {"class_name": "Activation", "config": {"name": "stack_3_block_2_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_2_ffn_gelu", "inbound_nodes": [[["stack_3_block_2_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 256}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_2_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 257}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_2_ffn_2_conv", "inbound_nodes": [[["stack_3_block_2_ffn_gelu", 0, 0, {}]]], "shared_object_id": 258}, {"class_name": "Add", "config": {"name": "stack_3_block_2_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_2_ffn_output", "inbound_nodes": [[["stack_3_block_2_output", 0, 0, {}], ["stack_3_block_2_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 259}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_3_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 260}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 261}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_3_preact_ln", "inbound_nodes": [[["stack_3_block_2_ffn_output", 0, 0, {}]]], "shared_object_id": 262}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_3_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 263}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_3_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_3_preact_ln", 0, 0, {}]]], "shared_object_id": 264}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_10", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_10", "inbound_nodes": [["stack_3_block_3_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]], "shared_object_id": 265}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_2", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_2", "inbound_nodes": [["tf.reshape_10", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]], "shared_object_id": 266}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_11", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_11", "inbound_nodes": [["tf.split_2", 0, 0, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 267}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_12", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_12", "inbound_nodes": [["tf.split_2", 0, 1, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 268}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_8", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_8", "inbound_nodes": [["tf.reshape_11", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 269}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_9", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_9", "inbound_nodes": [["tf.reshape_12", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 270}, {"class_name": "Lambda", "config": {"name": "lambda_4", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_4", "inbound_nodes": [[["tf.compat.v1.transpose_8", 0, 0, {}], ["tf.compat.v1.transpose_9", 0, 0, {}]]], "shared_object_id": 271}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_2", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_2", "inbound_nodes": [["lambda_4", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 272}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_3_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_3_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_2", 0, 0, {}]]], "shared_object_id": 273}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_13", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_13", "inbound_nodes": [["tf.split_2", 0, 2, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 274}, {"class_name": "Softmax", "config": {"name": "stack_3_block_3_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_3_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_3_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 275}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_10", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_10", "inbound_nodes": [["tf.reshape_13", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 276}, {"class_name": "Lambda", "config": {"name": "lambda_5", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_5", "inbound_nodes": [[["stack_3_block_3_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_10", 0, 0, {}]]], "shared_object_id": 277}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_11", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_11", "inbound_nodes": [["lambda_5", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 278}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_14", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_14", "inbound_nodes": [["tf.compat.v1.transpose_11", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 279}, {"class_name": "Dense", "config": {"name": "stack_3_block_3_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 280}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 281}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_3_mhsa_output", "inbound_nodes": [[["tf.reshape_14", 0, 0, {}]]], "shared_object_id": 282}, {"class_name": "Add", "config": {"name": "stack_3_block_3_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_3_output", "inbound_nodes": [[["stack_3_block_2_ffn_output", 0, 0, {}], ["stack_3_block_3_mhsa_output", 0, 0, {}]]], "shared_object_id": 283}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_3_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 284}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 285}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_3_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_3_output", 0, 0, {}]]], "shared_object_id": 286}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_3_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 287}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_3_ffn_1_conv", "inbound_nodes": [[["stack_3_block_3_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 288}, {"class_name": "Activation", "config": {"name": "stack_3_block_3_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_3_ffn_gelu", "inbound_nodes": [[["stack_3_block_3_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 289}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_3_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 290}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_3_ffn_2_conv", "inbound_nodes": [[["stack_3_block_3_ffn_gelu", 0, 0, {}]]], "shared_object_id": 291}, {"class_name": "Add", "config": {"name": "stack_3_block_3_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_3_ffn_output", "inbound_nodes": [[["stack_3_block_3_output", 0, 0, {}], ["stack_3_block_3_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 292}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_4_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 293}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 294}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_4_preact_ln", "inbound_nodes": [[["stack_3_block_3_ffn_output", 0, 0, {}]]], "shared_object_id": 295}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_4_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 296}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_4_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_4_preact_ln", 0, 0, {}]]], "shared_object_id": 297}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_15", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_15", "inbound_nodes": [["stack_3_block_4_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]], "shared_object_id": 298}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_3", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_3", "inbound_nodes": [["tf.reshape_15", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]], "shared_object_id": 299}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_16", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_16", "inbound_nodes": [["tf.split_3", 0, 0, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 300}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_17", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_17", "inbound_nodes": [["tf.split_3", 0, 1, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 301}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_12", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_12", "inbound_nodes": [["tf.reshape_16", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 302}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_13", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_13", "inbound_nodes": [["tf.reshape_17", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 303}, {"class_name": "Lambda", "config": {"name": "lambda_6", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_6", "inbound_nodes": [[["tf.compat.v1.transpose_12", 0, 0, {}], ["tf.compat.v1.transpose_13", 0, 0, {}]]], "shared_object_id": 304}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_3", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_3", "inbound_nodes": [["lambda_6", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 305}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_4_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_4_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_3", 0, 0, {}]]], "shared_object_id": 306}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_18", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_18", "inbound_nodes": [["tf.split_3", 0, 2, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 307}, {"class_name": "Softmax", "config": {"name": "stack_3_block_4_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_4_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_4_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 308}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_14", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_14", "inbound_nodes": [["tf.reshape_18", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 309}, {"class_name": "Lambda", "config": {"name": "lambda_7", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_7", "inbound_nodes": [[["stack_3_block_4_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_14", 0, 0, {}]]], "shared_object_id": 310}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_15", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_15", "inbound_nodes": [["lambda_7", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 311}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_19", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_19", "inbound_nodes": [["tf.compat.v1.transpose_15", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 312}, {"class_name": "Dense", "config": {"name": "stack_3_block_4_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 313}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 314}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_4_mhsa_output", "inbound_nodes": [[["tf.reshape_19", 0, 0, {}]]], "shared_object_id": 315}, {"class_name": "Add", "config": {"name": "stack_3_block_4_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_4_output", "inbound_nodes": [[["stack_3_block_3_ffn_output", 0, 0, {}], ["stack_3_block_4_mhsa_output", 0, 0, {}]]], "shared_object_id": 316}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_4_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 317}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 318}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_4_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_4_output", 0, 0, {}]]], "shared_object_id": 319}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_4_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 320}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_4_ffn_1_conv", "inbound_nodes": [[["stack_3_block_4_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 321}, {"class_name": "Activation", "config": {"name": "stack_3_block_4_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_4_ffn_gelu", "inbound_nodes": [[["stack_3_block_4_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 322}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_4_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 323}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_4_ffn_2_conv", "inbound_nodes": [[["stack_3_block_4_ffn_gelu", 0, 0, {}]]], "shared_object_id": 324}, {"class_name": "Add", "config": {"name": "stack_3_block_4_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_4_ffn_output", "inbound_nodes": [[["stack_3_block_4_output", 0, 0, {}], ["stack_3_block_4_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 325}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_5_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 326}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 327}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_5_preact_ln", "inbound_nodes": [[["stack_3_block_4_ffn_output", 0, 0, {}]]], "shared_object_id": 328}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_5_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 329}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_5_mhsa_qkv_conv", "inbound_nodes": [[["stack_3_block_5_preact_ln", 0, 0, {}]]], "shared_object_id": 330}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_20", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_20", "inbound_nodes": [["stack_3_block_5_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]], "shared_object_id": 331}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_4", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_4", "inbound_nodes": [["tf.reshape_20", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]], "shared_object_id": 332}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_21", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_21", "inbound_nodes": [["tf.split_4", 0, 0, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 333}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_22", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_22", "inbound_nodes": [["tf.split_4", 0, 1, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 334}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_16", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_16", "inbound_nodes": [["tf.reshape_21", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 335}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_17", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_17", "inbound_nodes": [["tf.reshape_22", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 336}, {"class_name": "Lambda", "config": {"name": "lambda_8", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_8", "inbound_nodes": [[["tf.compat.v1.transpose_16", 0, 0, {}], ["tf.compat.v1.transpose_17", 0, 0, {}]]], "shared_object_id": 337}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_4", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_4", "inbound_nodes": [["lambda_8", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 338}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_5_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "name": "stack_3_block_5_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_4", 0, 0, {}]]], "shared_object_id": 339}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_23", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_23", "inbound_nodes": [["tf.split_4", 0, 2, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 340}, {"class_name": "Softmax", "config": {"name": "stack_3_block_5_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_3_block_5_mhsa_attention_scores", "inbound_nodes": [[["stack_3_block_5_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 341}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_18", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_18", "inbound_nodes": [["tf.reshape_23", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 342}, {"class_name": "Lambda", "config": {"name": "lambda_9", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_9", "inbound_nodes": [[["stack_3_block_5_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_18", 0, 0, {}]]], "shared_object_id": 343}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_19", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_19", "inbound_nodes": [["lambda_9", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 344}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_24", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_24", "inbound_nodes": [["tf.compat.v1.transpose_19", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 345}, {"class_name": "Dense", "config": {"name": "stack_3_block_5_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 346}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 347}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_5_mhsa_output", "inbound_nodes": [[["tf.reshape_24", 0, 0, {}]]], "shared_object_id": 348}, {"class_name": "Add", "config": {"name": "stack_3_block_5_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_5_output", "inbound_nodes": [[["stack_3_block_4_ffn_output", 0, 0, {}], ["stack_3_block_5_mhsa_output", 0, 0, {}]]], "shared_object_id": 349}, {"class_name": "LayerNormalization", "config": {"name": "stack_3_block_5_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 350}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 351}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_3_block_5_ffn_preact_ln", "inbound_nodes": [[["stack_3_block_5_output", 0, 0, {}]]], "shared_object_id": 352}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_5_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 353}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_5_ffn_1_conv", "inbound_nodes": [[["stack_3_block_5_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 354}, {"class_name": "Activation", "config": {"name": "stack_3_block_5_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_3_block_5_ffn_gelu", "inbound_nodes": [[["stack_3_block_5_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 355}, {"class_name": "Conv2D", "config": {"name": "stack_3_block_5_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 356}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_3_block_5_ffn_2_conv", "inbound_nodes": [[["stack_3_block_5_ffn_gelu", 0, 0, {}]]], "shared_object_id": 357}, {"class_name": "Add", "config": {"name": "stack_3_block_5_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_3_block_5_ffn_output", "inbound_nodes": [[["stack_3_block_5_output", 0, 0, {}], ["stack_3_block_5_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 358}, {"class_name": "LayerNormalization", "config": {"name": "stack_4_block_1_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 359}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 360}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_4_block_1_preact_ln", "inbound_nodes": [[["stack_3_block_5_ffn_output", 0, 0, {}]]], "shared_object_id": 361}, {"class_name": "MaxPooling2D", "config": {"name": "stack_4_block_1_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_4_block_1_pool", "inbound_nodes": [[["stack_4_block_1_preact_ln", 0, 0, {}]]], "shared_object_id": 362}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_1_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 363}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_mhsa_qkv_conv", "inbound_nodes": [[["stack_4_block_1_pool", 0, 0, {}]]], "shared_object_id": 364}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_25", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_25", "inbound_nodes": [["stack_4_block_1_mhsa_qkv_conv", 0, 0, {"shape": [-1, 49, 1536]}]], "shared_object_id": 365}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_5", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_5", "inbound_nodes": [["tf.reshape_25", 0, 0, {"num_or_size_splits": [384, 384, 768], "axis": -1}]], "shared_object_id": 366}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_26", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_26", "inbound_nodes": [["tf.split_5", 0, 0, {"shape": [-1, 49, 12, 32]}]], "shared_object_id": 367}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_27", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_27", "inbound_nodes": [["tf.split_5", 0, 1, {"shape": [-1, 49, 12, 32]}]], "shared_object_id": 368}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_20", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_20", "inbound_nodes": [["tf.reshape_26", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 369}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_21", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_21", "inbound_nodes": [["tf.reshape_27", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 370}, {"class_name": "Lambda", "config": {"name": "lambda_10", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_10", "inbound_nodes": [[["tf.compat.v1.transpose_20", 0, 0, {}], ["tf.compat.v1.transpose_21", 0, 0, {}]]], "shared_object_id": 371}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_5", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_5", "inbound_nodes": [["lambda_10", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 372}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_4_block_1_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 7, "num_heads": -1}, "name": "stack_4_block_1_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_5", 0, 0, {}]]], "shared_object_id": 373}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_28", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_28", "inbound_nodes": [["tf.split_5", 0, 2, {"shape": [-1, 49, 12, 64]}]], "shared_object_id": 374}, {"class_name": "Softmax", "config": {"name": "stack_4_block_1_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_4_block_1_mhsa_attention_scores", "inbound_nodes": [[["stack_4_block_1_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 375}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_22", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_22", "inbound_nodes": [["tf.reshape_28", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 376}, {"class_name": "Lambda", "config": {"name": "lambda_11", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_11", "inbound_nodes": [[["stack_4_block_1_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_22", 0, 0, {}]]], "shared_object_id": 377}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_23", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_23", "inbound_nodes": [["lambda_11", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 378}, {"class_name": "MaxPooling2D", "config": {"name": "stack_4_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "name": "stack_4_block_1_shortcut_pool", "inbound_nodes": [[["stack_3_block_5_ffn_output", 0, 0, {}]]], "shared_object_id": 379}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_29", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_29", "inbound_nodes": [["tf.compat.v1.transpose_23", 0, 0, {"shape": [-1, 7, 7, 768]}]], "shared_object_id": 380}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 381}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_shortcut_conv", "inbound_nodes": [[["stack_4_block_1_shortcut_pool", 0, 0, {}]]], "shared_object_id": 382}, {"class_name": "Dense", "config": {"name": "stack_4_block_1_mhsa_output", "trainable": true, "dtype": "float32", "units": 768, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 383}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 384}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_mhsa_output", "inbound_nodes": [[["tf.reshape_29", 0, 0, {}]]], "shared_object_id": 385}, {"class_name": "Add", "config": {"name": "stack_4_block_1_output", "trainable": true, "dtype": "float32"}, "name": "stack_4_block_1_output", "inbound_nodes": [[["stack_4_block_1_shortcut_conv", 0, 0, {}], ["stack_4_block_1_mhsa_output", 0, 0, {}]]], "shared_object_id": 386}, {"class_name": "LayerNormalization", "config": {"name": "stack_4_block_1_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 387}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 388}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_4_block_1_ffn_preact_ln", "inbound_nodes": [[["stack_4_block_1_output", 0, 0, {}]]], "shared_object_id": 389}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_1_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 3072, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 390}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_ffn_1_conv", "inbound_nodes": [[["stack_4_block_1_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 391}, {"class_name": "Activation", "config": {"name": "stack_4_block_1_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_4_block_1_ffn_gelu", "inbound_nodes": [[["stack_4_block_1_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 392}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_1_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 393}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_1_ffn_2_conv", "inbound_nodes": [[["stack_4_block_1_ffn_gelu", 0, 0, {}]]], "shared_object_id": 394}, {"class_name": "Add", "config": {"name": "stack_4_block_1_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_4_block_1_ffn_output", "inbound_nodes": [[["stack_4_block_1_output", 0, 0, {}], ["stack_4_block_1_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 395}, {"class_name": "LayerNormalization", "config": {"name": "stack_4_block_2_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 396}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 397}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_4_block_2_preact_ln", "inbound_nodes": [[["stack_4_block_1_ffn_output", 0, 0, {}]]], "shared_object_id": 398}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_2_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 2304, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 399}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_2_mhsa_qkv_conv", "inbound_nodes": [[["stack_4_block_2_preact_ln", 0, 0, {}]]], "shared_object_id": 400}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_30", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_30", "inbound_nodes": [["stack_4_block_2_mhsa_qkv_conv", 0, 0, {"shape": [-1, 49, 2304]}]], "shared_object_id": 401}, {"class_name": "TFOpLambda", "config": {"name": "tf.split_6", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split_6", "inbound_nodes": [["tf.reshape_30", 0, 0, {"num_or_size_splits": [768, 768, 768], "axis": -1}]], "shared_object_id": 402}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_31", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_31", "inbound_nodes": [["tf.split_6", 0, 0, {"shape": [-1, 49, 24, 32]}]], "shared_object_id": 403}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_32", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_32", "inbound_nodes": [["tf.split_6", 0, 1, {"shape": [-1, 49, 24, 32]}]], "shared_object_id": 404}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_24", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_24", "inbound_nodes": [["tf.reshape_31", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 405}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_25", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_25", "inbound_nodes": [["tf.reshape_32", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 406}, {"class_name": "Lambda", "config": {"name": "lambda_12", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_12", "inbound_nodes": [[["tf.compat.v1.transpose_24", 0, 0, {}], ["tf.compat.v1.transpose_25", 0, 0, {}]]], "shared_object_id": 407}, {"class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_6", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "name": "tf.math.multiply_6", "inbound_nodes": [["lambda_12", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 408}, {"class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_4_block_2_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 7, "num_heads": -1}, "name": "stack_4_block_2_mhsa_pos_emb", "inbound_nodes": [[["tf.math.multiply_6", 0, 0, {}]]], "shared_object_id": 409}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_33", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_33", "inbound_nodes": [["tf.split_6", 0, 2, {"shape": [-1, 49, 24, 32]}]], "shared_object_id": 410}, {"class_name": "Softmax", "config": {"name": "stack_4_block_2_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "name": "stack_4_block_2_mhsa_attention_scores", "inbound_nodes": [[["stack_4_block_2_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 411}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_26", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_26", "inbound_nodes": [["tf.reshape_33", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 412}, {"class_name": "Lambda", "config": {"name": "lambda_13", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "name": "lambda_13", "inbound_nodes": [[["stack_4_block_2_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_26", 0, 0, {}]]], "shared_object_id": 413}, {"class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_27", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "name": "tf.compat.v1.transpose_27", "inbound_nodes": [["lambda_13", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 414}, {"class_name": "TFOpLambda", "config": {"name": "tf.reshape_34", "trainable": true, "dtype": "float32", "function": "reshape"}, "name": "tf.reshape_34", "inbound_nodes": [["tf.compat.v1.transpose_27", 0, 0, {"shape": [-1, 7, 7, 768]}]], "shared_object_id": 415}, {"class_name": "Dense", "config": {"name": "stack_4_block_2_mhsa_output", "trainable": true, "dtype": "float32", "units": 768, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 416}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 417}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_2_mhsa_output", "inbound_nodes": [[["tf.reshape_34", 0, 0, {}]]], "shared_object_id": 418}, {"class_name": "Add", "config": {"name": "stack_4_block_2_output", "trainable": true, "dtype": "float32"}, "name": "stack_4_block_2_output", "inbound_nodes": [[["stack_4_block_1_ffn_output", 0, 0, {}], ["stack_4_block_2_mhsa_output", 0, 0, {}]]], "shared_object_id": 419}, {"class_name": "LayerNormalization", "config": {"name": "stack_4_block_2_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 420}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 421}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "name": "stack_4_block_2_ffn_preact_ln", "inbound_nodes": [[["stack_4_block_2_output", 0, 0, {}]]], "shared_object_id": 422}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_2_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 3072, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 423}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_2_ffn_1_conv", "inbound_nodes": [[["stack_4_block_2_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 424}, {"class_name": "Activation", "config": {"name": "stack_4_block_2_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "name": "stack_4_block_2_ffn_gelu", "inbound_nodes": [[["stack_4_block_2_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 425}, {"class_name": "Conv2D", "config": {"name": "stack_4_block_2_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 426}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "stack_4_block_2_ffn_2_conv", "inbound_nodes": [[["stack_4_block_2_ffn_gelu", 0, 0, {}]]], "shared_object_id": 427}, {"class_name": "Add", "config": {"name": "stack_4_block_2_ffn_output", "trainable": true, "dtype": "float32"}, "name": "stack_4_block_2_ffn_output", "inbound_nodes": [[["stack_4_block_2_output", 0, 0, {}], ["stack_4_block_2_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 428}, {"class_name": "GlobalAveragePooling2D", "config": {"name": "avg_pool", "trainable": true, "dtype": "float32", "data_format": "channels_last", "keepdims": false}, "name": "avg_pool", "inbound_nodes": [[["stack_4_block_2_ffn_output", 0, 0, {}]]], "shared_object_id": 429}, {"class_name": "Dense", "config": {"name": "predictions", "trainable": true, "dtype": "float32", "units": 11, "activation": "softmax", "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 430}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 431}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "name": "predictions", "inbound_nodes": [[["avg_pool", 0, 0, {}]]], "shared_object_id": 432}], "input_layers": [["input_3", 0, 0]], "output_layers": [["predictions", 0, 0]]}}}2
root.layer-0"_tf_keras_input_layer*Ú{"class_name": "InputLayer", "name": "input_3", "dtype": "float32", "sparse": false, "ragged": false, "batch_input_shape": {"class_name": "__tuple__", "items": [null, 224, 224, 3]}, "config": {"batch_input_shape": {"class_name": "__tuple__", "items": [null, 224, 224, 3]}, "dtype": "float32", "sparse": false, "ragged": false, "name": "input_3"}}2
Úroot.layer-1"_tf_keras_layer*°{"name": "stem_1_pad", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "ZeroPadding2D", "config": {"name": "stem_1_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "inbound_nodes": [[["input_3", 0, 0, {}]]], "shared_object_id": 1, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 435}}2
È
root.layer_with_weights-0"_tf_keras_layer*
{"name": "stem_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stem_1_conv", "trainable": true, "dtype": "float32", "filters": 64, "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 3}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stem_1_pad", 0, 0, {}]]], "shared_object_id": 4, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 3}}, "shared_object_id": 436}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 226, 226, 3]}}2
¨	root.layer_with_weights-1"_tf_keras_layer*ñ{"name": "stem_1_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stem_1_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 5}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 6}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 7}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 8}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stem_1_conv", 0, 0, {}]]], "shared_object_id": 9, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 64}}, "shared_object_id": 437}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 112, 112, 64]}}2
root.layer-4"_tf_keras_layer*ð{"name": "stem_1_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stem_1_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stem_1_bn", 0, 0, {}]]], "shared_object_id": 10}2
ßroot.layer-5"_tf_keras_layer*µ{"name": "stem_2_pad", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "ZeroPadding2D", "config": {"name": "stem_2_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "inbound_nodes": [[["stem_1_gelu", 0, 0, {}]]], "shared_object_id": 11, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 438}}2
Ì
root.layer_with_weights-2"_tf_keras_layer*
{"name": "stem_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stem_2_conv", "trainable": true, "dtype": "float32", "filters": 64, "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 12}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stem_2_pad", 0, 0, {}]]], "shared_object_id": 13, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 64}}, "shared_object_id": 439}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 114, 114, 64]}}2
Í	root.layer_with_weights-3"_tf_keras_layer*	{"name": "stack_1_block_1_preact_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_1_block_1_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 14}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 15}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 16}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 17}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stem_2_conv", 0, 0, {}]]], "shared_object_id": 18, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 64}}, "shared_object_id": 440}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 112, 112, 64]}}2
û
	root.layer_with_weights-4"_tf_keras_layer*Ä
{"name": "stack_1_block_1_expand_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_1_block_1_expand_conv", "trainable": true, "dtype": "float32", "filters": 256, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 19}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_1_block_1_preact_bn", 0, 0, {}]]], "shared_object_id": 20, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 64}}, "shared_object_id": 441}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 112, 112, 64]}}2
ß	
root.layer_with_weights-5"_tf_keras_layer*¨	{"name": "stack_1_block_1_expand_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_1_block_1_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 21}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 22}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 23}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 24}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_1_block_1_expand_conv", 0, 0, {}]]], "shared_object_id": 25, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 256}}, "shared_object_id": 442}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 112, 112, 256]}}2
Ëroot.layer-10"_tf_keras_layer* {"name": "stack_1_block_1_expand_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_1_block_1_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_1_block_1_expand_bn", 0, 0, {}]]], "shared_object_id": 26}2
root.layer-11"_tf_keras_layer*ã{"name": "stack_1_block_1_MB_dw_pad", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "ZeroPadding2D", "config": {"name": "stack_1_block_1_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_1_block_1_expand_gelu", 0, 0, {}]]], "shared_object_id": 27, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 443}}2
Ï
root.layer_with_weights-6"_tf_keras_layer*
{"name": "stack_1_block_1_MB_dw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "DepthwiseConv2D", "config": {"name": "stack_1_block_1_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 28}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 29}, "depthwise_regularizer": null, "depthwise_constraint": null}, "inbound_nodes": [[["stack_1_block_1_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 30, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 256}}, "shared_object_id": 444}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 114, 114, 256]}}2
Ú	root.layer_with_weights-7"_tf_keras_layer*£	{"name": "stack_1_block_1_MB_dw_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_1_block_1_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 31}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 32}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 33}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 34}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_1_block_1_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 35, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 256}}, "shared_object_id": 445}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 256]}}2
Èroot.layer-14"_tf_keras_layer*{"name": "stack_1_block_1_MB_dw_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_1_block_1_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_1_block_1_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 36}2
ãroot.layer-15"_tf_keras_layer*¸{"name": "tf.math.reduce_mean", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "inbound_nodes": [["stack_1_block_1_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 37}2
î
root.layer_with_weights-8"_tf_keras_layer*·
{"name": "stack_1_block_1_se_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_1_block_1_se_1_conv", "trainable": true, "dtype": "float32", "filters": 16, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 38}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.math.reduce_mean", 0, 0, {}]]], "shared_object_id": 39, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 256}}, "shared_object_id": 446}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 256]}}2
Ãroot.layer-17"_tf_keras_layer*{"name": "stack_1_block_1_se_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_1_block_1_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_1_block_1_se_1_conv", 0, 0, {}]]], "shared_object_id": 40}2
ñ
root.layer_with_weights-9"_tf_keras_layer*º
{"name": "stack_1_block_1_se_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_1_block_1_se_2_conv", "trainable": true, "dtype": "float32", "filters": 256, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 41}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_1_block_1_se_gelu", 0, 0, {}]]], "shared_object_id": 42, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 16}}, "shared_object_id": 447}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 16]}}2
Ìroot.layer-19"_tf_keras_layer*¡{"name": "stack_1_block_1_se_sigmoid", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_1_block_1_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "inbound_nodes": [[["stack_1_block_1_se_2_conv", 0, 0, {}]]], "shared_object_id": 43}2
ýroot.layer-20"_tf_keras_layer*Ò{"name": "stack_1_block_1_shortcut_pool", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "MaxPooling2D", "config": {"name": "stack_1_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "inbound_nodes": [[["stem_2_conv", 0, 0, {}]]], "shared_object_id": 44, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 448}}2
ãroot.layer-21"_tf_keras_layer*¸{"name": "stack_1_block_1_se_out", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Multiply", "config": {"name": "stack_1_block_1_se_out", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_1_block_1_MB_dw_gelu", 0, 0, {}], ["stack_1_block_1_se_sigmoid", 0, 0, {}]]], "shared_object_id": 45, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 56, 56, 256]}, {"class_name": "TensorShape", "items": [null, 1, 1, 256]}]}2
root.layer_with_weights-10"_tf_keras_layer*Ê
{"name": "stack_1_block_1_shortcut_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_1_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 96, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 46}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_1_block_1_shortcut_pool", 0, 0, {}]]], "shared_object_id": 47, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 64}}, "shared_object_id": 449}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 64]}}2
ö
root.layer_with_weights-11"_tf_keras_layer*¾
{"name": "stack_1_block_1_MB_pw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_1_block_1_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 96, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 48}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_1_block_1_se_out", 0, 0, {}]]], "shared_object_id": 49, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 256}}, "shared_object_id": 450}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 256]}}2
ároot.layer-24"_tf_keras_layer*¶{"name": "stack_1_block_1_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_1_block_1_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_1_block_1_shortcut_conv", 0, 0, {}], ["stack_1_block_1_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 50, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 56, 56, 96]}, {"class_name": "TensorShape", "items": [null, 56, 56, 96]}]}2
×	root.layer_with_weights-12"_tf_keras_layer*	{"name": "stack_1_block_2_preact_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_1_block_2_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 51}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 52}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 53}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 54}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_1_block_1_output", 0, 0, {}]]], "shared_object_id": 55, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 96}}, "shared_object_id": 451}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 96]}}2
ú
root.layer_with_weights-13"_tf_keras_layer*Â
{"name": "stack_1_block_2_expand_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_1_block_2_expand_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 56}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_1_block_2_preact_bn", 0, 0, {}]]], "shared_object_id": 57, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 96}}, "shared_object_id": 452}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 96]}}2
Þ	root.layer_with_weights-14"_tf_keras_layer*¦	{"name": "stack_1_block_2_expand_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_1_block_2_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 58}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 59}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 60}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 61}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_1_block_2_expand_conv", 0, 0, {}]]], "shared_object_id": 62, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 384}}, "shared_object_id": 453}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 384]}}2
Ëroot.layer-28"_tf_keras_layer* {"name": "stack_1_block_2_expand_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_1_block_2_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_1_block_2_expand_bn", 0, 0, {}]]], "shared_object_id": 63}2
root.layer-29"_tf_keras_layer*ã{"name": "stack_1_block_2_MB_dw_pad", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "ZeroPadding2D", "config": {"name": "stack_1_block_2_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_1_block_2_expand_gelu", 0, 0, {}]]], "shared_object_id": 64, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 454}}2
Î
root.layer_with_weights-15"_tf_keras_layer*
{"name": "stack_1_block_2_MB_dw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "DepthwiseConv2D", "config": {"name": "stack_1_block_2_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 65}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 66}, "depthwise_regularizer": null, "depthwise_constraint": null}, "inbound_nodes": [[["stack_1_block_2_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 67, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 455}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 58, 58, 384]}}2
Û	 root.layer_with_weights-16"_tf_keras_layer*£	{"name": "stack_1_block_2_MB_dw_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_1_block_2_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 68}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 69}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 70}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 71}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_1_block_2_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 72, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 384}}, "shared_object_id": 456}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 384]}}2
È!root.layer-32"_tf_keras_layer*{"name": "stack_1_block_2_MB_dw_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_1_block_2_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_1_block_2_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 73}2
ç"root.layer-33"_tf_keras_layer*¼{"name": "tf.math.reduce_mean_1", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_1", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "inbound_nodes": [["stack_1_block_2_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 74}2
ñ
#root.layer_with_weights-17"_tf_keras_layer*¹
{"name": "stack_1_block_2_se_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_1_block_2_se_1_conv", "trainable": true, "dtype": "float32", "filters": 24, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 75}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.math.reduce_mean_1", 0, 0, {}]]], "shared_object_id": 76, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 457}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 384]}}2
Ã$root.layer-35"_tf_keras_layer*{"name": "stack_1_block_2_se_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_1_block_2_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_1_block_2_se_1_conv", 0, 0, {}]]], "shared_object_id": 77}2
ò
%root.layer_with_weights-18"_tf_keras_layer*º
{"name": "stack_1_block_2_se_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_1_block_2_se_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 78}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_1_block_2_se_gelu", 0, 0, {}]]], "shared_object_id": 79, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 24}}, "shared_object_id": 458}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 24]}}2
Ì&root.layer-37"_tf_keras_layer*¡{"name": "stack_1_block_2_se_sigmoid", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_1_block_2_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "inbound_nodes": [[["stack_1_block_2_se_2_conv", 0, 0, {}]]], "shared_object_id": 80}2
ã'root.layer-38"_tf_keras_layer*¸{"name": "stack_1_block_2_se_out", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Multiply", "config": {"name": "stack_1_block_2_se_out", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_1_block_2_MB_dw_gelu", 0, 0, {}], ["stack_1_block_2_se_sigmoid", 0, 0, {}]]], "shared_object_id": 81, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 56, 56, 384]}, {"class_name": "TensorShape", "items": [null, 1, 1, 384]}]}2
ö
(root.layer_with_weights-19"_tf_keras_layer*¾
{"name": "stack_1_block_2_MB_pw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_1_block_2_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 96, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 82}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_1_block_2_se_out", 0, 0, {}]]], "shared_object_id": 83, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 459}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 384]}}2
Ú)root.layer-40"_tf_keras_layer*¯{"name": "stack_1_block_2_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_1_block_2_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_1_block_1_output", 0, 0, {}], ["stack_1_block_2_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 84, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 56, 56, 96]}, {"class_name": "TensorShape", "items": [null, 56, 56, 96]}]}2
×	*root.layer_with_weights-20"_tf_keras_layer*	{"name": "stack_2_block_1_preact_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_2_block_1_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 85}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 86}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 87}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 88}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_1_block_2_output", 0, 0, {}]]], "shared_object_id": 89, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 96}}, "shared_object_id": 460}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 96]}}2
ú
+root.layer_with_weights-21"_tf_keras_layer*Â
{"name": "stack_2_block_1_expand_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_1_expand_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 90}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_1_preact_bn", 0, 0, {}]]], "shared_object_id": 91, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 96}}, "shared_object_id": 461}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 96]}}2
Þ	,root.layer_with_weights-22"_tf_keras_layer*¦	{"name": "stack_2_block_1_expand_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_2_block_1_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 92}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 93}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 94}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 95}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_2_block_1_expand_conv", 0, 0, {}]]], "shared_object_id": 96, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 384}}, "shared_object_id": 462}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 56, 56, 384]}}2
Ë-root.layer-44"_tf_keras_layer* {"name": "stack_2_block_1_expand_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_1_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_2_block_1_expand_bn", 0, 0, {}]]], "shared_object_id": 97}2
.root.layer-45"_tf_keras_layer*ã{"name": "stack_2_block_1_MB_dw_pad", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "ZeroPadding2D", "config": {"name": "stack_2_block_1_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_2_block_1_expand_gelu", 0, 0, {}]]], "shared_object_id": 98, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 463}}2
Ð
/root.layer_with_weights-23"_tf_keras_layer*
{"name": "stack_2_block_1_MB_dw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "DepthwiseConv2D", "config": {"name": "stack_2_block_1_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 99}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 100}, "depthwise_regularizer": null, "depthwise_constraint": null}, "inbound_nodes": [[["stack_2_block_1_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 101, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 464}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 58, 58, 384]}}2
à	0root.layer_with_weights-24"_tf_keras_layer*¨	{"name": "stack_2_block_1_MB_dw_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_2_block_1_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 102}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 103}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 104}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 105}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_2_block_1_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 106, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 384}}, "shared_object_id": 465}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 384]}}2
É1root.layer-48"_tf_keras_layer*{"name": "stack_2_block_1_MB_dw_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_1_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_2_block_1_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 107}2
è2root.layer-49"_tf_keras_layer*½{"name": "tf.math.reduce_mean_2", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_2", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "inbound_nodes": [["stack_2_block_1_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 108}2
ó
3root.layer_with_weights-25"_tf_keras_layer*»
{"name": "stack_2_block_1_se_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_1_se_1_conv", "trainable": true, "dtype": "float32", "filters": 24, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 109}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.math.reduce_mean_2", 0, 0, {}]]], "shared_object_id": 110, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 466}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 384]}}2
Ä4root.layer-51"_tf_keras_layer*{"name": "stack_2_block_1_se_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_1_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_2_block_1_se_1_conv", 0, 0, {}]]], "shared_object_id": 111}2
ô
5root.layer_with_weights-26"_tf_keras_layer*¼
{"name": "stack_2_block_1_se_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_1_se_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 112}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_1_se_gelu", 0, 0, {}]]], "shared_object_id": 113, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 24}}, "shared_object_id": 467}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 24]}}2
Í6root.layer-53"_tf_keras_layer*¢{"name": "stack_2_block_1_se_sigmoid", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_1_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "inbound_nodes": [[["stack_2_block_1_se_2_conv", 0, 0, {}]]], "shared_object_id": 114}2
7root.layer-54"_tf_keras_layer*Þ{"name": "stack_2_block_1_shortcut_pool", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "MaxPooling2D", "config": {"name": "stack_2_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_1_block_2_output", 0, 0, {}]]], "shared_object_id": 115, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 468}}2
ä8root.layer-55"_tf_keras_layer*¹{"name": "stack_2_block_1_se_out", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Multiply", "config": {"name": "stack_2_block_1_se_out", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_2_block_1_MB_dw_gelu", 0, 0, {}], ["stack_2_block_1_se_sigmoid", 0, 0, {}]]], "shared_object_id": 116, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 28, 28, 384]}, {"class_name": "TensorShape", "items": [null, 1, 1, 384]}]}2
9root.layer_with_weights-27"_tf_keras_layer*Í
{"name": "stack_2_block_1_shortcut_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 117}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_1_shortcut_pool", 0, 0, {}]]], "shared_object_id": 118, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 96}}, "shared_object_id": 469}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 96]}}2
ù
:root.layer_with_weights-28"_tf_keras_layer*Á
{"name": "stack_2_block_1_MB_pw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_1_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 119}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_1_se_out", 0, 0, {}]]], "shared_object_id": 120, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 470}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 384]}}2
ä;root.layer-58"_tf_keras_layer*¹{"name": "stack_2_block_1_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_2_block_1_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_2_block_1_shortcut_conv", 0, 0, {}], ["stack_2_block_1_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 121, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 28, 28, 192]}, {"class_name": "TensorShape", "items": [null, 28, 28, 192]}]}2
Þ	<root.layer_with_weights-29"_tf_keras_layer*¦	{"name": "stack_2_block_2_preact_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_2_block_2_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 122}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 123}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 124}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 125}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_2_block_1_output", 0, 0, {}]]], "shared_object_id": 126, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 192}}, "shared_object_id": 471}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 192]}}2
þ
=root.layer_with_weights-30"_tf_keras_layer*Æ
{"name": "stack_2_block_2_expand_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_2_expand_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 127}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_2_preact_bn", 0, 0, {}]]], "shared_object_id": 128, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 192}}, "shared_object_id": 472}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 192]}}2
ã	>root.layer_with_weights-31"_tf_keras_layer*«	{"name": "stack_2_block_2_expand_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_2_block_2_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 129}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 130}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 131}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 132}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_2_block_2_expand_conv", 0, 0, {}]]], "shared_object_id": 133, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 768}}, "shared_object_id": 473}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 768]}}2
Ì?root.layer-62"_tf_keras_layer*¡{"name": "stack_2_block_2_expand_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_2_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_2_block_2_expand_bn", 0, 0, {}]]], "shared_object_id": 134}2
@root.layer-63"_tf_keras_layer*ä{"name": "stack_2_block_2_MB_dw_pad", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "ZeroPadding2D", "config": {"name": "stack_2_block_2_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_2_block_2_expand_gelu", 0, 0, {}]]], "shared_object_id": 135, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 474}}2
Ñ
Aroot.layer_with_weights-32"_tf_keras_layer*
{"name": "stack_2_block_2_MB_dw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "DepthwiseConv2D", "config": {"name": "stack_2_block_2_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 136}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 137}, "depthwise_regularizer": null, "depthwise_constraint": null}, "inbound_nodes": [[["stack_2_block_2_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 138, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 768}}, "shared_object_id": 475}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 30, 30, 768]}}2
à	Broot.layer_with_weights-33"_tf_keras_layer*¨	{"name": "stack_2_block_2_MB_dw_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_2_block_2_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 139}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 140}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 141}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 142}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_2_block_2_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 143, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 768}}, "shared_object_id": 476}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 768]}}2
ÉCroot.layer-66"_tf_keras_layer*{"name": "stack_2_block_2_MB_dw_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_2_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_2_block_2_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 144}2
èDroot.layer-67"_tf_keras_layer*½{"name": "tf.math.reduce_mean_3", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_3", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "inbound_nodes": [["stack_2_block_2_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 145}2
ó
Eroot.layer_with_weights-34"_tf_keras_layer*»
{"name": "stack_2_block_2_se_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_2_se_1_conv", "trainable": true, "dtype": "float32", "filters": 48, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 146}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.math.reduce_mean_3", 0, 0, {}]]], "shared_object_id": 147, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 768}}, "shared_object_id": 477}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 768]}}2
ÄFroot.layer-69"_tf_keras_layer*{"name": "stack_2_block_2_se_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_2_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_2_block_2_se_1_conv", 0, 0, {}]]], "shared_object_id": 148}2
ô
Groot.layer_with_weights-35"_tf_keras_layer*¼
{"name": "stack_2_block_2_se_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_2_se_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 149}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_2_se_gelu", 0, 0, {}]]], "shared_object_id": 150, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 48}}, "shared_object_id": 478}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 48]}}2
ÍHroot.layer-71"_tf_keras_layer*¢{"name": "stack_2_block_2_se_sigmoid", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_2_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "inbound_nodes": [[["stack_2_block_2_se_2_conv", 0, 0, {}]]], "shared_object_id": 151}2
äIroot.layer-72"_tf_keras_layer*¹{"name": "stack_2_block_2_se_out", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Multiply", "config": {"name": "stack_2_block_2_se_out", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_2_block_2_MB_dw_gelu", 0, 0, {}], ["stack_2_block_2_se_sigmoid", 0, 0, {}]]], "shared_object_id": 152, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 28, 28, 768]}, {"class_name": "TensorShape", "items": [null, 1, 1, 768]}]}2
ù
Jroot.layer_with_weights-36"_tf_keras_layer*Á
{"name": "stack_2_block_2_MB_pw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_2_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 153}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_2_se_out", 0, 0, {}]]], "shared_object_id": 154, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 768}}, "shared_object_id": 479}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 768]}}2
ÝKroot.layer-74"_tf_keras_layer*²{"name": "stack_2_block_2_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_2_block_2_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_2_block_1_output", 0, 0, {}], ["stack_2_block_2_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 155, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 28, 28, 192]}, {"class_name": "TensorShape", "items": [null, 28, 28, 192]}]}2
Þ	Lroot.layer_with_weights-37"_tf_keras_layer*¦	{"name": "stack_2_block_3_preact_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_2_block_3_preact_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 156}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 157}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 158}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 159}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_2_block_2_output", 0, 0, {}]]], "shared_object_id": 160, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 192}}, "shared_object_id": 480}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 192]}}2
þ
Mroot.layer_with_weights-38"_tf_keras_layer*Æ
{"name": "stack_2_block_3_expand_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_3_expand_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 161}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_3_preact_bn", 0, 0, {}]]], "shared_object_id": 162, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 192}}, "shared_object_id": 481}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 192]}}2
ã	Nroot.layer_with_weights-39"_tf_keras_layer*«	{"name": "stack_2_block_3_expand_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_2_block_3_expand_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 163}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 164}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 165}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 166}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_2_block_3_expand_conv", 0, 0, {}]]], "shared_object_id": 167, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 768}}, "shared_object_id": 482}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 768]}}2
ÌOroot.layer-78"_tf_keras_layer*¡{"name": "stack_2_block_3_expand_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_3_expand_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_2_block_3_expand_bn", 0, 0, {}]]], "shared_object_id": 168}2
Proot.layer-79"_tf_keras_layer*ä{"name": "stack_2_block_3_MB_dw_pad", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "ZeroPadding2D", "config": {"name": "stack_2_block_3_MB_dw_pad", "trainable": true, "dtype": "float32", "padding": {"class_name": "__tuple__", "items": [{"class_name": "__tuple__", "items": [1, 1]}, {"class_name": "__tuple__", "items": [1, 1]}]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_2_block_3_expand_gelu", 0, 0, {}]]], "shared_object_id": 169, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 483}}2
Ñ
Qroot.layer_with_weights-40"_tf_keras_layer*
{"name": "stack_2_block_3_MB_dw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "DepthwiseConv2D", "config": {"name": "stack_2_block_3_MB_dw_conv", "trainable": true, "dtype": "float32", "kernel_size": {"class_name": "__tuple__", "items": [3, 3]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 170}, "bias_regularizer": null, "activity_regularizer": null, "bias_constraint": null, "depth_multiplier": 1, "depthwise_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 171}, "depthwise_regularizer": null, "depthwise_constraint": null}, "inbound_nodes": [[["stack_2_block_3_MB_dw_pad", 0, 0, {}]]], "shared_object_id": 172, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 768}}, "shared_object_id": 484}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 30, 30, 768]}}2
à	Rroot.layer_with_weights-41"_tf_keras_layer*¨	{"name": "stack_2_block_3_MB_dw_bn", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "BatchNormalization", "config": {"name": "stack_2_block_3_MB_dw_bn", "trainable": true, "dtype": "float32", "axis": [3], "momentum": 0.9, "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 173}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 174}, "moving_mean_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 175}, "moving_variance_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 176}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_2_block_3_MB_dw_conv", 0, 0, {}]]], "shared_object_id": 177, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {"3": 768}}, "shared_object_id": 485}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 768]}}2
ÉSroot.layer-82"_tf_keras_layer*{"name": "stack_2_block_3_MB_dw_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_3_MB_dw_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_2_block_3_MB_dw_bn", 0, 0, {}]]], "shared_object_id": 178}2
èTroot.layer-83"_tf_keras_layer*½{"name": "tf.math.reduce_mean_4", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.reduce_mean_4", "trainable": true, "dtype": "float32", "function": "math.reduce_mean"}, "inbound_nodes": [["stack_2_block_3_MB_dw_gelu", 0, 0, {"axis": [1, 2], "keepdims": true}]], "shared_object_id": 179}2
ó
Uroot.layer_with_weights-42"_tf_keras_layer*»
{"name": "stack_2_block_3_se_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_3_se_1_conv", "trainable": true, "dtype": "float32", "filters": 48, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 180}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.math.reduce_mean_4", 0, 0, {}]]], "shared_object_id": 181, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 768}}, "shared_object_id": 486}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 768]}}2
ÄVroot.layer-85"_tf_keras_layer*{"name": "stack_2_block_3_se_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_3_se_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_2_block_3_se_1_conv", 0, 0, {}]]], "shared_object_id": 182}2
ô
Wroot.layer_with_weights-43"_tf_keras_layer*¼
{"name": "stack_2_block_3_se_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_3_se_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": true, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 183}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_3_se_gelu", 0, 0, {}]]], "shared_object_id": 184, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 48}}, "shared_object_id": 487}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 1, 1, 48]}}2
ÍXroot.layer-87"_tf_keras_layer*¢{"name": "stack_2_block_3_se_sigmoid", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_2_block_3_se_sigmoid", "trainable": true, "dtype": "float32", "activation": "sigmoid"}, "inbound_nodes": [[["stack_2_block_3_se_2_conv", 0, 0, {}]]], "shared_object_id": 185}2
äYroot.layer-88"_tf_keras_layer*¹{"name": "stack_2_block_3_se_out", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Multiply", "config": {"name": "stack_2_block_3_se_out", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_2_block_3_MB_dw_gelu", 0, 0, {}], ["stack_2_block_3_se_sigmoid", 0, 0, {}]]], "shared_object_id": 186, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 28, 28, 768]}, {"class_name": "TensorShape", "items": [null, 1, 1, 768]}]}2
ù
Zroot.layer_with_weights-44"_tf_keras_layer*Á
{"name": "stack_2_block_3_MB_pw_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_2_block_3_MB_pw_conv", "trainable": true, "dtype": "float32", "filters": 192, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "same", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 187}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_2_block_3_se_out", 0, 0, {}]]], "shared_object_id": 188, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 768}}, "shared_object_id": 488}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 768]}}2
Ý[root.layer-90"_tf_keras_layer*²{"name": "stack_2_block_3_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_2_block_3_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_2_block_2_output", 0, 0, {}], ["stack_2_block_3_MB_pw_conv", 0, 0, {}]]], "shared_object_id": 189, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 28, 28, 192]}, {"class_name": "TensorShape", "items": [null, 28, 28, 192]}]}2
ä\root.layer_with_weights-45"_tf_keras_layer*¬{"name": "stack_3_block_1_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_1_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 190}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 191}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_2_block_3_output", 0, 0, {}]]], "shared_object_id": 192, "build_input_shape": {"class_name": "TensorShape", "items": [null, 28, 28, 192]}}2
ú]root.layer-92"_tf_keras_layer*Ï{"name": "stack_3_block_1_pool", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "MaxPooling2D", "config": {"name": "stack_3_block_1_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_3_block_1_preact_ln", 0, 0, {}]]], "shared_object_id": 193, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 489}}2
þ
^root.layer_with_weights-46"_tf_keras_layer*Æ
{"name": "stack_3_block_1_mhsa_qkv_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_1_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 194}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_1_pool", 0, 0, {}]]], "shared_object_id": 195, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 192}}, "shared_object_id": 490}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 192]}}2
Ã_root.layer-94"_tf_keras_layer*{"name": "tf.reshape", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["stack_3_block_1_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 768]}]], "shared_object_id": 196}2
Ä`root.layer-95"_tf_keras_layer*{"name": "tf.split", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.split", "trainable": true, "dtype": "float32", "function": "split"}, "inbound_nodes": [["tf.reshape", 0, 0, {"num_or_size_splits": [192, 192, 384], "axis": -1}]], "shared_object_id": 197}2
´aroot.layer-96"_tf_keras_layer*{"name": "tf.reshape_1", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_1", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split", 0, 0, {"shape": [-1, 196, 6, 32]}]], "shared_object_id": 198}2
´broot.layer-97"_tf_keras_layer*{"name": "tf.reshape_2", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_2", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split", 0, 1, {"shape": [-1, 196, 6, 32]}]], "shared_object_id": 199}2
ücroot.layer-98"_tf_keras_layer*Ñ{"name": "tf.compat.v1.transpose", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_1", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 200}2
droot.layer-99"_tf_keras_layer*Õ{"name": "tf.compat.v1.transpose_1", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_1", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_2", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 201}2
«eroot.layer-100"_tf_keras_layer*ÿ{"name": "lambda", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["tf.compat.v1.transpose", 0, 0, {}], ["tf.compat.v1.transpose_1", 0, 0, {}]]], "shared_object_id": 202}2
Ífroot.layer-101"_tf_keras_layer*¡{"name": "tf.math.multiply", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.multiply", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "inbound_nodes": [["lambda", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 203}2
égroot.layer_with_weights-47"_tf_keras_layer*±{"name": "stack_3_block_1_mhsa_pos_emb", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_1_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "inbound_nodes": [[["tf.math.multiply", 0, 0, {}]]], "shared_object_id": 204, "build_input_shape": {"class_name": "TensorShape", "items": [null, 6, 196, 196]}}2
µhroot.layer-103"_tf_keras_layer*{"name": "tf.reshape_3", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_3", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split", 0, 2, {"shape": [-1, 196, 6, 64]}]], "shared_object_id": 205}2
×iroot.layer-104"_tf_keras_layer*«{"name": "stack_3_block_1_mhsa_attention_scores", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Softmax", "config": {"name": "stack_3_block_1_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "inbound_nodes": [[["stack_3_block_1_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 206}2
jroot.layer-105"_tf_keras_layer*Õ{"name": "tf.compat.v1.transpose_2", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_2", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_3", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 207}2
¾kroot.layer-106"_tf_keras_layer*{"name": "lambda_1", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_1", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["stack_3_block_1_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_2", 0, 0, {}]]], "shared_object_id": 208}2
ýlroot.layer-107"_tf_keras_layer*Ñ{"name": "tf.compat.v1.transpose_3", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_3", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["lambda_1", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 209}2
mroot.layer-108"_tf_keras_layer*Þ{"name": "stack_3_block_1_shortcut_pool", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "MaxPooling2D", "config": {"name": "stack_3_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_2_block_3_output", 0, 0, {}]]], "shared_object_id": 210, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 491}}2
Ænroot.layer-109"_tf_keras_layer*{"name": "tf.reshape_4", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_4", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.compat.v1.transpose_3", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 211}2
oroot.layer_with_weights-48"_tf_keras_layer*Ï
{"name": "stack_3_block_1_shortcut_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 212}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_1_shortcut_pool", 0, 0, {}]]], "shared_object_id": 213, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 192}}, "shared_object_id": 492}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 192]}}2
´proot.layer_with_weights-49"_tf_keras_layer*ü{"name": "stack_3_block_1_mhsa_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Dense", "config": {"name": "stack_3_block_1_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 214}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 215}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.reshape_4", 0, 0, {}]]], "shared_object_id": 216, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 2, "axes": {"-1": 384}}, "shared_object_id": 493}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
æqroot.layer-112"_tf_keras_layer*º{"name": "stack_3_block_1_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_1_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_1_shortcut_conv", 0, 0, {}], ["stack_3_block_1_mhsa_output", 0, 0, {}]]], "shared_object_id": 217, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
ìrroot.layer_with_weights-50"_tf_keras_layer*´{"name": "stack_3_block_1_ffn_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_1_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 218}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 219}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_1_output", 0, 0, {}]]], "shared_object_id": 220, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
sroot.layer_with_weights-51"_tf_keras_layer*Ê
{"name": "stack_3_block_1_ffn_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_1_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 221}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_1_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 222, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 494}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
Ètroot.layer-115"_tf_keras_layer*{"name": "stack_3_block_1_ffn_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_3_block_1_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_3_block_1_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 223}2
þ
uroot.layer_with_weights-52"_tf_keras_layer*Æ
{"name": "stack_3_block_1_ffn_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_1_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 224}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_1_ffn_gelu", 0, 0, {}]]], "shared_object_id": 225, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 1536}}, "shared_object_id": 495}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 1536]}}2
ævroot.layer-117"_tf_keras_layer*º{"name": "stack_3_block_1_ffn_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_1_ffn_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_1_output", 0, 0, {}], ["stack_3_block_1_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 226, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
èwroot.layer_with_weights-53"_tf_keras_layer*°{"name": "stack_3_block_2_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_2_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 227}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 228}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_1_ffn_output", 0, 0, {}]]], "shared_object_id": 229, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
xroot.layer_with_weights-54"_tf_keras_layer*Ì
{"name": "stack_3_block_2_mhsa_qkv_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_2_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 230}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_2_preact_ln", 0, 0, {}]]], "shared_object_id": 231, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 496}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
Éyroot.layer-120"_tf_keras_layer*{"name": "tf.reshape_5", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_5", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["stack_3_block_2_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]], "shared_object_id": 232}2
Ëzroot.layer-121"_tf_keras_layer*{"name": "tf.split_1", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.split_1", "trainable": true, "dtype": "float32", "function": "split"}, "inbound_nodes": [["tf.reshape_5", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]], "shared_object_id": 233}2
¸{root.layer-122"_tf_keras_layer*{"name": "tf.reshape_6", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_6", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_1", 0, 0, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 234}2
¸|root.layer-123"_tf_keras_layer*{"name": "tf.reshape_7", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_7", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_1", 0, 1, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 235}2
}root.layer-124"_tf_keras_layer*Õ{"name": "tf.compat.v1.transpose_4", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_4", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_6", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 236}2
~root.layer-125"_tf_keras_layer*Õ{"name": "tf.compat.v1.transpose_5", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_5", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_7", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 237}2
±root.layer-126"_tf_keras_layer*{"name": "lambda_2", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_2", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["tf.compat.v1.transpose_4", 0, 0, {}], ["tf.compat.v1.transpose_5", 0, 0, {}]]], "shared_object_id": 238}2
Ôroot.layer-127"_tf_keras_layer*§{"name": "tf.math.multiply_1", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_1", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "inbound_nodes": [["lambda_2", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 239}2
íroot.layer_with_weights-55"_tf_keras_layer*´{"name": "stack_3_block_2_mhsa_pos_emb", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_2_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "inbound_nodes": [[["tf.math.multiply_1", 0, 0, {}]]], "shared_object_id": 240, "build_input_shape": {"class_name": "TensorShape", "items": [null, 12, 196, 196]}}2
¹root.layer-129"_tf_keras_layer*{"name": "tf.reshape_8", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_8", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_1", 0, 2, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 241}2
Øroot.layer-130"_tf_keras_layer*«{"name": "stack_3_block_2_mhsa_attention_scores", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Softmax", "config": {"name": "stack_3_block_2_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "inbound_nodes": [[["stack_3_block_2_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 242}2
root.layer-131"_tf_keras_layer*Õ{"name": "tf.compat.v1.transpose_6", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_6", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_8", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 243}2
¿root.layer-132"_tf_keras_layer*{"name": "lambda_3", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_3", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["stack_3_block_2_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_6", 0, 0, {}]]], "shared_object_id": 244}2
þroot.layer-133"_tf_keras_layer*Ñ{"name": "tf.compat.v1.transpose_7", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_7", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["lambda_3", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 245}2
Çroot.layer-134"_tf_keras_layer*{"name": "tf.reshape_9", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_9", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.compat.v1.transpose_7", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 246}2
µroot.layer_with_weights-56"_tf_keras_layer*ü{"name": "stack_3_block_2_mhsa_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Dense", "config": {"name": "stack_3_block_2_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 247}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 248}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.reshape_9", 0, 0, {}]]], "shared_object_id": 249, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 2, "axes": {"-1": 384}}, "shared_object_id": 497}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
äroot.layer-136"_tf_keras_layer*·{"name": "stack_3_block_2_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_2_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_1_ffn_output", 0, 0, {}], ["stack_3_block_2_mhsa_output", 0, 0, {}]]], "shared_object_id": 250, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
íroot.layer_with_weights-57"_tf_keras_layer*´{"name": "stack_3_block_2_ffn_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_2_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 251}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 252}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_2_output", 0, 0, {}]]], "shared_object_id": 253, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
root.layer_with_weights-58"_tf_keras_layer*Ê
{"name": "stack_3_block_2_ffn_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_2_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 254}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_2_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 255, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 498}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
Éroot.layer-139"_tf_keras_layer*{"name": "stack_3_block_2_ffn_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_3_block_2_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_3_block_2_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 256}2
ÿ
root.layer_with_weights-59"_tf_keras_layer*Æ
{"name": "stack_3_block_2_ffn_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_2_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 257}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_2_ffn_gelu", 0, 0, {}]]], "shared_object_id": 258, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 1536}}, "shared_object_id": 499}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 1536]}}2
çroot.layer-141"_tf_keras_layer*º{"name": "stack_3_block_2_ffn_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_2_ffn_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_2_output", 0, 0, {}], ["stack_3_block_2_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 259, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
éroot.layer_with_weights-60"_tf_keras_layer*°{"name": "stack_3_block_3_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_3_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 260}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 261}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_2_ffn_output", 0, 0, {}]]], "shared_object_id": 262, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
root.layer_with_weights-61"_tf_keras_layer*Ì
{"name": "stack_3_block_3_mhsa_qkv_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_3_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 263}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_3_preact_ln", 0, 0, {}]]], "shared_object_id": 264, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 500}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
Ìroot.layer-144"_tf_keras_layer*{"name": "tf.reshape_10", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_10", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["stack_3_block_3_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]], "shared_object_id": 265}2
Íroot.layer-145"_tf_keras_layer* {"name": "tf.split_2", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.split_2", "trainable": true, "dtype": "float32", "function": "split"}, "inbound_nodes": [["tf.reshape_10", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]], "shared_object_id": 266}2
»root.layer-146"_tf_keras_layer*{"name": "tf.reshape_11", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_11", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_2", 0, 0, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 267}2
»root.layer-147"_tf_keras_layer*{"name": "tf.reshape_12", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_12", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_2", 0, 1, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 268}2
root.layer-148"_tf_keras_layer*Ö{"name": "tf.compat.v1.transpose_8", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_8", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_11", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 269}2
root.layer-149"_tf_keras_layer*Ö{"name": "tf.compat.v1.transpose_9", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_9", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_12", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 270}2
²root.layer-150"_tf_keras_layer*{"name": "lambda_4", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_4", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["tf.compat.v1.transpose_8", 0, 0, {}], ["tf.compat.v1.transpose_9", 0, 0, {}]]], "shared_object_id": 271}2
Ôroot.layer-151"_tf_keras_layer*§{"name": "tf.math.multiply_2", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_2", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "inbound_nodes": [["lambda_4", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 272}2
íroot.layer_with_weights-62"_tf_keras_layer*´{"name": "stack_3_block_3_mhsa_pos_emb", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_3_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "inbound_nodes": [[["tf.math.multiply_2", 0, 0, {}]]], "shared_object_id": 273, "build_input_shape": {"class_name": "TensorShape", "items": [null, 12, 196, 196]}}2
»root.layer-153"_tf_keras_layer*{"name": "tf.reshape_13", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_13", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_2", 0, 2, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 274}2
Øroot.layer-154"_tf_keras_layer*«{"name": "stack_3_block_3_mhsa_attention_scores", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Softmax", "config": {"name": "stack_3_block_3_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "inbound_nodes": [[["stack_3_block_3_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 275}2
root.layer-155"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_10", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_10", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_13", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 276}2
Àroot.layer-156"_tf_keras_layer*{"name": "lambda_5", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_5", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["stack_3_block_3_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_10", 0, 0, {}]]], "shared_object_id": 277}2
root.layer-157"_tf_keras_layer*Ó{"name": "tf.compat.v1.transpose_11", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_11", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["lambda_5", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 278}2
Êroot.layer-158"_tf_keras_layer*{"name": "tf.reshape_14", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_14", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.compat.v1.transpose_11", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 279}2
¶ root.layer_with_weights-63"_tf_keras_layer*ý{"name": "stack_3_block_3_mhsa_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Dense", "config": {"name": "stack_3_block_3_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 280}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 281}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.reshape_14", 0, 0, {}]]], "shared_object_id": 282, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 2, "axes": {"-1": 384}}, "shared_object_id": 501}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
ä¡root.layer-160"_tf_keras_layer*·{"name": "stack_3_block_3_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_3_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_2_ffn_output", 0, 0, {}], ["stack_3_block_3_mhsa_output", 0, 0, {}]]], "shared_object_id": 283, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
í¢root.layer_with_weights-64"_tf_keras_layer*´{"name": "stack_3_block_3_ffn_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_3_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 284}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 285}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_3_output", 0, 0, {}]]], "shared_object_id": 286, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
£root.layer_with_weights-65"_tf_keras_layer*Ê
{"name": "stack_3_block_3_ffn_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_3_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 287}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_3_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 288, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 502}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
É¤root.layer-163"_tf_keras_layer*{"name": "stack_3_block_3_ffn_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_3_block_3_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_3_block_3_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 289}2
ÿ
¥root.layer_with_weights-66"_tf_keras_layer*Æ
{"name": "stack_3_block_3_ffn_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_3_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 290}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_3_ffn_gelu", 0, 0, {}]]], "shared_object_id": 291, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 1536}}, "shared_object_id": 503}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 1536]}}2
ç¦root.layer-165"_tf_keras_layer*º{"name": "stack_3_block_3_ffn_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_3_ffn_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_3_output", 0, 0, {}], ["stack_3_block_3_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 292, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
é§root.layer_with_weights-67"_tf_keras_layer*°{"name": "stack_3_block_4_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_4_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 293}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 294}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_3_ffn_output", 0, 0, {}]]], "shared_object_id": 295, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
¨root.layer_with_weights-68"_tf_keras_layer*Ì
{"name": "stack_3_block_4_mhsa_qkv_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_4_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 296}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_4_preact_ln", 0, 0, {}]]], "shared_object_id": 297, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 504}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
Ì©root.layer-168"_tf_keras_layer*{"name": "tf.reshape_15", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_15", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["stack_3_block_4_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]], "shared_object_id": 298}2
Íªroot.layer-169"_tf_keras_layer* {"name": "tf.split_3", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.split_3", "trainable": true, "dtype": "float32", "function": "split"}, "inbound_nodes": [["tf.reshape_15", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]], "shared_object_id": 299}2
»«root.layer-170"_tf_keras_layer*{"name": "tf.reshape_16", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_16", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_3", 0, 0, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 300}2
»¬root.layer-171"_tf_keras_layer*{"name": "tf.reshape_17", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_17", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_3", 0, 1, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 301}2
­root.layer-172"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_12", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_12", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_16", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 302}2
®root.layer-173"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_13", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_13", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_17", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 303}2
´¯root.layer-174"_tf_keras_layer*{"name": "lambda_6", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_6", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["tf.compat.v1.transpose_12", 0, 0, {}], ["tf.compat.v1.transpose_13", 0, 0, {}]]], "shared_object_id": 304}2
Ô°root.layer-175"_tf_keras_layer*§{"name": "tf.math.multiply_3", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_3", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "inbound_nodes": [["lambda_6", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 305}2
í±root.layer_with_weights-69"_tf_keras_layer*´{"name": "stack_3_block_4_mhsa_pos_emb", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_4_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "inbound_nodes": [[["tf.math.multiply_3", 0, 0, {}]]], "shared_object_id": 306, "build_input_shape": {"class_name": "TensorShape", "items": [null, 12, 196, 196]}}2
»²root.layer-177"_tf_keras_layer*{"name": "tf.reshape_18", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_18", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_3", 0, 2, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 307}2
Ø³root.layer-178"_tf_keras_layer*«{"name": "stack_3_block_4_mhsa_attention_scores", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Softmax", "config": {"name": "stack_3_block_4_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "inbound_nodes": [[["stack_3_block_4_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 308}2
´root.layer-179"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_14", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_14", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_18", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 309}2
Àµroot.layer-180"_tf_keras_layer*{"name": "lambda_7", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_7", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["stack_3_block_4_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_14", 0, 0, {}]]], "shared_object_id": 310}2
¶root.layer-181"_tf_keras_layer*Ó{"name": "tf.compat.v1.transpose_15", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_15", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["lambda_7", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 311}2
Ê·root.layer-182"_tf_keras_layer*{"name": "tf.reshape_19", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_19", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.compat.v1.transpose_15", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 312}2
¶¸root.layer_with_weights-70"_tf_keras_layer*ý{"name": "stack_3_block_4_mhsa_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Dense", "config": {"name": "stack_3_block_4_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 313}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 314}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.reshape_19", 0, 0, {}]]], "shared_object_id": 315, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 2, "axes": {"-1": 384}}, "shared_object_id": 505}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
ä¹root.layer-184"_tf_keras_layer*·{"name": "stack_3_block_4_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_4_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_3_ffn_output", 0, 0, {}], ["stack_3_block_4_mhsa_output", 0, 0, {}]]], "shared_object_id": 316, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
íºroot.layer_with_weights-71"_tf_keras_layer*´{"name": "stack_3_block_4_ffn_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_4_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 317}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 318}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_4_output", 0, 0, {}]]], "shared_object_id": 319, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
»root.layer_with_weights-72"_tf_keras_layer*Ê
{"name": "stack_3_block_4_ffn_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_4_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 320}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_4_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 321, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 506}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
É¼root.layer-187"_tf_keras_layer*{"name": "stack_3_block_4_ffn_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_3_block_4_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_3_block_4_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 322}2
ÿ
½root.layer_with_weights-73"_tf_keras_layer*Æ
{"name": "stack_3_block_4_ffn_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_4_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 323}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_4_ffn_gelu", 0, 0, {}]]], "shared_object_id": 324, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 1536}}, "shared_object_id": 507}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 1536]}}2
ç¾root.layer-189"_tf_keras_layer*º{"name": "stack_3_block_4_ffn_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_4_ffn_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_4_output", 0, 0, {}], ["stack_3_block_4_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 325, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
é¿root.layer_with_weights-74"_tf_keras_layer*°{"name": "stack_3_block_5_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_5_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 326}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 327}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_4_ffn_output", 0, 0, {}]]], "shared_object_id": 328, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
Àroot.layer_with_weights-75"_tf_keras_layer*Ì
{"name": "stack_3_block_5_mhsa_qkv_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_5_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1152, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 329}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_5_preact_ln", 0, 0, {}]]], "shared_object_id": 330, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 508}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
ÌÁroot.layer-192"_tf_keras_layer*{"name": "tf.reshape_20", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_20", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["stack_3_block_5_mhsa_qkv_conv", 0, 0, {"shape": [-1, 196, 1152]}]], "shared_object_id": 331}2
ÍÂroot.layer-193"_tf_keras_layer* {"name": "tf.split_4", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.split_4", "trainable": true, "dtype": "float32", "function": "split"}, "inbound_nodes": [["tf.reshape_20", 0, 0, {"num_or_size_splits": [384, 384, 384], "axis": -1}]], "shared_object_id": 332}2
»Ãroot.layer-194"_tf_keras_layer*{"name": "tf.reshape_21", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_21", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_4", 0, 0, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 333}2
»Äroot.layer-195"_tf_keras_layer*{"name": "tf.reshape_22", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_22", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_4", 0, 1, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 334}2
Åroot.layer-196"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_16", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_16", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_21", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 335}2
Æroot.layer-197"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_17", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_17", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_22", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 336}2
´Çroot.layer-198"_tf_keras_layer*{"name": "lambda_8", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_8", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["tf.compat.v1.transpose_16", 0, 0, {}], ["tf.compat.v1.transpose_17", 0, 0, {}]]], "shared_object_id": 337}2
ÔÈroot.layer-199"_tf_keras_layer*§{"name": "tf.math.multiply_4", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_4", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "inbound_nodes": [["lambda_8", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 338}2
íÉroot.layer_with_weights-76"_tf_keras_layer*´{"name": "stack_3_block_5_mhsa_pos_emb", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_3_block_5_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 14, "num_heads": -1}, "inbound_nodes": [[["tf.math.multiply_4", 0, 0, {}]]], "shared_object_id": 339, "build_input_shape": {"class_name": "TensorShape", "items": [null, 12, 196, 196]}}2
»Êroot.layer-201"_tf_keras_layer*{"name": "tf.reshape_23", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_23", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_4", 0, 2, {"shape": [-1, 196, 12, 32]}]], "shared_object_id": 340}2
ØËroot.layer-202"_tf_keras_layer*«{"name": "stack_3_block_5_mhsa_attention_scores", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Softmax", "config": {"name": "stack_3_block_5_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "inbound_nodes": [[["stack_3_block_5_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 341}2
Ìroot.layer-203"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_18", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_18", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_23", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 342}2
ÀÍroot.layer-204"_tf_keras_layer*{"name": "lambda_9", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_9", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["stack_3_block_5_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_18", 0, 0, {}]]], "shared_object_id": 343}2
Îroot.layer-205"_tf_keras_layer*Ó{"name": "tf.compat.v1.transpose_19", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_19", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["lambda_9", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 344}2
ÊÏroot.layer-206"_tf_keras_layer*{"name": "tf.reshape_24", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_24", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.compat.v1.transpose_19", 0, 0, {"shape": [-1, 14, 14, 384]}]], "shared_object_id": 345}2
¶Ðroot.layer_with_weights-77"_tf_keras_layer*ý{"name": "stack_3_block_5_mhsa_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Dense", "config": {"name": "stack_3_block_5_mhsa_output", "trainable": true, "dtype": "float32", "units": 384, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 346}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 347}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.reshape_24", 0, 0, {}]]], "shared_object_id": 348, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 2, "axes": {"-1": 384}}, "shared_object_id": 509}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
äÑroot.layer-208"_tf_keras_layer*·{"name": "stack_3_block_5_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_5_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_4_ffn_output", 0, 0, {}], ["stack_3_block_5_mhsa_output", 0, 0, {}]]], "shared_object_id": 349, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
íÒroot.layer_with_weights-78"_tf_keras_layer*´{"name": "stack_3_block_5_ffn_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_3_block_5_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 350}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 351}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_5_output", 0, 0, {}]]], "shared_object_id": 352, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
Óroot.layer_with_weights-79"_tf_keras_layer*Ê
{"name": "stack_3_block_5_ffn_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_5_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 353}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_5_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 354, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 510}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
ÉÔroot.layer-211"_tf_keras_layer*{"name": "stack_3_block_5_ffn_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_3_block_5_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_3_block_5_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 355}2
ÿ
Õroot.layer_with_weights-80"_tf_keras_layer*Æ
{"name": "stack_3_block_5_ffn_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_3_block_5_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 384, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 356}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_3_block_5_ffn_gelu", 0, 0, {}]]], "shared_object_id": 357, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 1536}}, "shared_object_id": 511}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 1536]}}2
çÖroot.layer-213"_tf_keras_layer*º{"name": "stack_3_block_5_ffn_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_3_block_5_ffn_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_3_block_5_output", 0, 0, {}], ["stack_3_block_5_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 358, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 14, 14, 384]}, {"class_name": "TensorShape", "items": [null, 14, 14, 384]}]}2
é×root.layer_with_weights-81"_tf_keras_layer*°{"name": "stack_4_block_1_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_4_block_1_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 359}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 360}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_3_block_5_ffn_output", 0, 0, {}]]], "shared_object_id": 361, "build_input_shape": {"class_name": "TensorShape", "items": [null, 14, 14, 384]}}2
üØroot.layer-215"_tf_keras_layer*Ï{"name": "stack_4_block_1_pool", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "MaxPooling2D", "config": {"name": "stack_4_block_1_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_4_block_1_preact_ln", 0, 0, {}]]], "shared_object_id": 362, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 512}}2
þ
Ùroot.layer_with_weights-82"_tf_keras_layer*Å
{"name": "stack_4_block_1_mhsa_qkv_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_4_block_1_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 1536, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 363}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_4_block_1_pool", 0, 0, {}]]], "shared_object_id": 364, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 513}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 384]}}2
ËÚroot.layer-217"_tf_keras_layer*{"name": "tf.reshape_25", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_25", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["stack_4_block_1_mhsa_qkv_conv", 0, 0, {"shape": [-1, 49, 1536]}]], "shared_object_id": 365}2
ÍÛroot.layer-218"_tf_keras_layer* {"name": "tf.split_5", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.split_5", "trainable": true, "dtype": "float32", "function": "split"}, "inbound_nodes": [["tf.reshape_25", 0, 0, {"num_or_size_splits": [384, 384, 768], "axis": -1}]], "shared_object_id": 366}2
ºÜroot.layer-219"_tf_keras_layer*{"name": "tf.reshape_26", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_26", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_5", 0, 0, {"shape": [-1, 49, 12, 32]}]], "shared_object_id": 367}2
ºÝroot.layer-220"_tf_keras_layer*{"name": "tf.reshape_27", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_27", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_5", 0, 1, {"shape": [-1, 49, 12, 32]}]], "shared_object_id": 368}2
Þroot.layer-221"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_20", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_20", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_26", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 369}2
ßroot.layer-222"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_21", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_21", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_27", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 370}2
¶àroot.layer-223"_tf_keras_layer*{"name": "lambda_10", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_10", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["tf.compat.v1.transpose_20", 0, 0, {}], ["tf.compat.v1.transpose_21", 0, 0, {}]]], "shared_object_id": 371}2
Õároot.layer-224"_tf_keras_layer*¨{"name": "tf.math.multiply_5", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_5", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "inbound_nodes": [["lambda_10", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 372}2
êâroot.layer_with_weights-83"_tf_keras_layer*±{"name": "stack_4_block_1_mhsa_pos_emb", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_4_block_1_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 7, "num_heads": -1}, "inbound_nodes": [[["tf.math.multiply_5", 0, 0, {}]]], "shared_object_id": 373, "build_input_shape": {"class_name": "TensorShape", "items": [null, 12, 49, 49]}}2
ºãroot.layer-226"_tf_keras_layer*{"name": "tf.reshape_28", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_28", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_5", 0, 2, {"shape": [-1, 49, 12, 64]}]], "shared_object_id": 374}2
Øäroot.layer-227"_tf_keras_layer*«{"name": "stack_4_block_1_mhsa_attention_scores", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Softmax", "config": {"name": "stack_4_block_1_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "inbound_nodes": [[["stack_4_block_1_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 375}2
åroot.layer-228"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_22", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_22", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_28", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 376}2
Âæroot.layer-229"_tf_keras_layer*{"name": "lambda_11", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_11", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["stack_4_block_1_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_22", 0, 0, {}]]], "shared_object_id": 377}2
çroot.layer-230"_tf_keras_layer*Ô{"name": "tf.compat.v1.transpose_23", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_23", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["lambda_11", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 378}2
èroot.layer-231"_tf_keras_layer*â{"name": "stack_4_block_1_shortcut_pool", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "MaxPooling2D", "config": {"name": "stack_4_block_1_shortcut_pool", "trainable": true, "dtype": "float32", "pool_size": {"class_name": "__tuple__", "items": [2, 2]}, "padding": "same", "strides": {"class_name": "__tuple__", "items": [2, 2]}, "data_format": "channels_last"}, "inbound_nodes": [[["stack_3_block_5_ffn_output", 0, 0, {}]]], "shared_object_id": 379, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 514}}2
Èéroot.layer-232"_tf_keras_layer*{"name": "tf.reshape_29", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_29", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.compat.v1.transpose_23", 0, 0, {"shape": [-1, 7, 7, 768]}]], "shared_object_id": 380}2
êroot.layer_with_weights-84"_tf_keras_layer*Í
{"name": "stack_4_block_1_shortcut_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_4_block_1_shortcut_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 381}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_4_block_1_shortcut_pool", 0, 0, {}]]], "shared_object_id": 382, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 384}}, "shared_object_id": 515}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 384]}}2
´ëroot.layer_with_weights-85"_tf_keras_layer*û{"name": "stack_4_block_1_mhsa_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Dense", "config": {"name": "stack_4_block_1_mhsa_output", "trainable": true, "dtype": "float32", "units": 768, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 383}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 384}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.reshape_29", 0, 0, {}]]], "shared_object_id": 385, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 2, "axes": {"-1": 768}}, "shared_object_id": 516}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 768]}}2
ãìroot.layer-235"_tf_keras_layer*¶{"name": "stack_4_block_1_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_4_block_1_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_4_block_1_shortcut_conv", 0, 0, {}], ["stack_4_block_1_mhsa_output", 0, 0, {}]]], "shared_object_id": 386, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 7, 7, 768]}, {"class_name": "TensorShape", "items": [null, 7, 7, 768]}]}2
ëíroot.layer_with_weights-86"_tf_keras_layer*²{"name": "stack_4_block_1_ffn_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_4_block_1_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 387}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 388}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_4_block_1_output", 0, 0, {}]]], "shared_object_id": 389, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 768]}}2
îroot.layer_with_weights-87"_tf_keras_layer*È
{"name": "stack_4_block_1_ffn_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_4_block_1_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 3072, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 390}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_4_block_1_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 391, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 768}}, "shared_object_id": 517}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 768]}}2
Éïroot.layer-238"_tf_keras_layer*{"name": "stack_4_block_1_ffn_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_4_block_1_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_4_block_1_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 392}2
ý
ðroot.layer_with_weights-88"_tf_keras_layer*Ä
{"name": "stack_4_block_1_ffn_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_4_block_1_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 393}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_4_block_1_ffn_gelu", 0, 0, {}]]], "shared_object_id": 394, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 3072}}, "shared_object_id": 518}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 3072]}}2
ãñroot.layer-240"_tf_keras_layer*¶{"name": "stack_4_block_1_ffn_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_4_block_1_ffn_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_4_block_1_output", 0, 0, {}], ["stack_4_block_1_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 395, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 7, 7, 768]}, {"class_name": "TensorShape", "items": [null, 7, 7, 768]}]}2
çòroot.layer_with_weights-89"_tf_keras_layer*®{"name": "stack_4_block_2_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_4_block_2_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 396}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 397}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_4_block_1_ffn_output", 0, 0, {}]]], "shared_object_id": 398, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 768]}}2
óroot.layer_with_weights-90"_tf_keras_layer*Ê
{"name": "stack_4_block_2_mhsa_qkv_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_4_block_2_mhsa_qkv_conv", "trainable": true, "dtype": "float32", "filters": 2304, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 399}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_4_block_2_preact_ln", 0, 0, {}]]], "shared_object_id": 400, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 768}}, "shared_object_id": 519}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 768]}}2
Ëôroot.layer-243"_tf_keras_layer*{"name": "tf.reshape_30", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_30", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["stack_4_block_2_mhsa_qkv_conv", 0, 0, {"shape": [-1, 49, 2304]}]], "shared_object_id": 401}2
Íõroot.layer-244"_tf_keras_layer* {"name": "tf.split_6", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.split_6", "trainable": true, "dtype": "float32", "function": "split"}, "inbound_nodes": [["tf.reshape_30", 0, 0, {"num_or_size_splits": [768, 768, 768], "axis": -1}]], "shared_object_id": 402}2
ºöroot.layer-245"_tf_keras_layer*{"name": "tf.reshape_31", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_31", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_6", 0, 0, {"shape": [-1, 49, 24, 32]}]], "shared_object_id": 403}2
º÷root.layer-246"_tf_keras_layer*{"name": "tf.reshape_32", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_32", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_6", 0, 1, {"shape": [-1, 49, 24, 32]}]], "shared_object_id": 404}2
øroot.layer-247"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_24", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_24", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_31", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 405}2
ùroot.layer-248"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_25", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_25", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_32", 0, 0, {"perm": [0, 2, 3, 1], "name": "transpose", "conjugate": false}]], "shared_object_id": 406}2
¶úroot.layer-249"_tf_keras_layer*{"name": "lambda_12", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_12", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPisAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["tf.compat.v1.transpose_24", 0, 0, {}], ["tf.compat.v1.transpose_25", 0, 0, {}]]], "shared_object_id": 407}2
Õûroot.layer-250"_tf_keras_layer*¨{"name": "tf.math.multiply_6", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.math.multiply_6", "trainable": true, "dtype": "float32", "function": "math.multiply"}, "inbound_nodes": [["lambda_12", 0, 0, {"y": 0.1767766922712326, "name": null}]], "shared_object_id": 408}2
êüroot.layer_with_weights-91"_tf_keras_layer*±{"name": "stack_4_block_2_mhsa_pos_emb", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "beit>MultiHeadRelativePositionalEmbedding", "config": {"name": "stack_4_block_2_mhsa_pos_emb", "trainable": true, "dtype": "float32", "with_cls_token": false, "attn_height": 7, "num_heads": -1}, "inbound_nodes": [[["tf.math.multiply_6", 0, 0, {}]]], "shared_object_id": 409, "build_input_shape": {"class_name": "TensorShape", "items": [null, 24, 49, 49]}}2
ºýroot.layer-252"_tf_keras_layer*{"name": "tf.reshape_33", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_33", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.split_6", 0, 2, {"shape": [-1, 49, 24, 32]}]], "shared_object_id": 410}2
Øþroot.layer-253"_tf_keras_layer*«{"name": "stack_4_block_2_mhsa_attention_scores", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Softmax", "config": {"name": "stack_4_block_2_mhsa_attention_scores", "trainable": true, "dtype": "float32", "axis": -1}, "inbound_nodes": [[["stack_4_block_2_mhsa_pos_emb", 0, 0, {}]]], "shared_object_id": 411}2
ÿroot.layer-254"_tf_keras_layer*Ø{"name": "tf.compat.v1.transpose_26", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_26", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["tf.reshape_33", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 412}2
Âroot.layer-255"_tf_keras_layer*{"name": "lambda_13", "trainable": true, "expects_training_arg": true, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Lambda", "config": {"name": "lambda_13", "trainable": true, "dtype": "float32", "function": {"class_name": "__tuple__", "items": ["4wEAAAAAAAAAAQAAAAUAAABTAAAAcxQAAAB0AKABfABkARkAfABkAhkAoQJTACkDTukAAAAA6QEA\nAAApAtoCdGbaBm1hdG11bCkB2gJ4eKkAcgYAAAD6Uy91c3IvbG9jYWwvbGliL3B5dGhvbjMuNy9k\naXN0LXBhY2thZ2VzL2tlcmFzX2N2X2F0dGVudGlvbl9tb2RlbHMvY29hdG5ldC9jb2F0bmV0LnB5\n2gg8bGFtYmRhPjMAAADzAAAAAA==\n", null, null]}, "function_type": "lambda", "module": "keras_cv_attention_models.coatnet.coatnet", "output_shape": null, "output_shape_type": "raw", "output_shape_module": null, "arguments": {}}, "inbound_nodes": [[["stack_4_block_2_mhsa_attention_scores", 0, 0, {}], ["tf.compat.v1.transpose_26", 0, 0, {}]]], "shared_object_id": 413}2
root.layer-256"_tf_keras_layer*Ô{"name": "tf.compat.v1.transpose_27", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.compat.v1.transpose_27", "trainable": true, "dtype": "float32", "function": "compat.v1.transpose"}, "inbound_nodes": [["lambda_13", 0, 0, {"perm": [0, 2, 1, 3], "name": "transpose", "conjugate": false}]], "shared_object_id": 414}2
Èroot.layer-257"_tf_keras_layer*{"name": "tf.reshape_34", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": true, "class_name": "TFOpLambda", "config": {"name": "tf.reshape_34", "trainable": true, "dtype": "float32", "function": "reshape"}, "inbound_nodes": [["tf.compat.v1.transpose_27", 0, 0, {"shape": [-1, 7, 7, 768]}]], "shared_object_id": 415}2
´root.layer_with_weights-92"_tf_keras_layer*û{"name": "stack_4_block_2_mhsa_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Dense", "config": {"name": "stack_4_block_2_mhsa_output", "trainable": true, "dtype": "float32", "units": 768, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 416}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 417}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["tf.reshape_34", 0, 0, {}]]], "shared_object_id": 418, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 2, "axes": {"-1": 768}}, "shared_object_id": 520}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 768]}}2
àroot.layer-259"_tf_keras_layer*³{"name": "stack_4_block_2_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_4_block_2_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_4_block_1_ffn_output", 0, 0, {}], ["stack_4_block_2_mhsa_output", 0, 0, {}]]], "shared_object_id": 419, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 7, 7, 768]}, {"class_name": "TensorShape", "items": [null, 7, 7, 768]}]}2
ëroot.layer_with_weights-93"_tf_keras_layer*²{"name": "stack_4_block_2_ffn_preact_ln", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "LayerNormalization", "config": {"name": "stack_4_block_2_ffn_preact_ln", "trainable": true, "dtype": "float32", "axis": [3], "epsilon": 1e-05, "center": true, "scale": true, "beta_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 420}, "gamma_initializer": {"class_name": "Ones", "config": {}, "shared_object_id": 421}, "beta_regularizer": null, "gamma_regularizer": null, "beta_constraint": null, "gamma_constraint": null}, "inbound_nodes": [[["stack_4_block_2_output", 0, 0, {}]]], "shared_object_id": 422, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 768]}}2
root.layer_with_weights-94"_tf_keras_layer*È
{"name": "stack_4_block_2_ffn_1_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_4_block_2_ffn_1_conv", "trainable": true, "dtype": "float32", "filters": 3072, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 423}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_4_block_2_ffn_preact_ln", 0, 0, {}]]], "shared_object_id": 424, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 768}}, "shared_object_id": 521}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 768]}}2
Éroot.layer-262"_tf_keras_layer*{"name": "stack_4_block_2_ffn_gelu", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Activation", "config": {"name": "stack_4_block_2_ffn_gelu", "trainable": true, "dtype": "float32", "activation": "gelu"}, "inbound_nodes": [[["stack_4_block_2_ffn_1_conv", 0, 0, {}]]], "shared_object_id": 425}2
ý
root.layer_with_weights-95"_tf_keras_layer*Ä
{"name": "stack_4_block_2_ffn_2_conv", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Conv2D", "config": {"name": "stack_4_block_2_ffn_2_conv", "trainable": true, "dtype": "float32", "filters": 768, "kernel_size": {"class_name": "__tuple__", "items": [1, 1]}, "strides": {"class_name": "__tuple__", "items": [1, 1]}, "padding": "valid", "data_format": "channels_last", "dilation_rate": {"class_name": "__tuple__", "items": [1, 1]}, "groups": 1, "activation": "linear", "use_bias": false, "kernel_initializer": {"class_name": "VarianceScaling", "config": {"scale": 2.0, "mode": "fan_out", "distribution": "truncated_normal", "seed": null}, "shared_object_id": 2}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 426}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["stack_4_block_2_ffn_gelu", 0, 0, {}]]], "shared_object_id": 427, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 4, "axes": {"-1": 3072}}, "shared_object_id": 522}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 7, 7, 3072]}}2
ãroot.layer-264"_tf_keras_layer*¶{"name": "stack_4_block_2_ffn_output", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Add", "config": {"name": "stack_4_block_2_ffn_output", "trainable": true, "dtype": "float32"}, "inbound_nodes": [[["stack_4_block_2_output", 0, 0, {}], ["stack_4_block_2_ffn_2_conv", 0, 0, {}]]], "shared_object_id": 428, "build_input_shape": [{"class_name": "TensorShape", "items": [null, 7, 7, 768]}, {"class_name": "TensorShape", "items": [null, 7, 7, 768]}]}2
ûroot.layer-265"_tf_keras_layer*Î{"name": "avg_pool", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "GlobalAveragePooling2D", "config": {"name": "avg_pool", "trainable": true, "dtype": "float32", "data_format": "channels_last", "keepdims": false}, "inbound_nodes": [[["stack_4_block_2_ffn_output", 0, 0, {}]]], "shared_object_id": 429, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": 4, "max_ndim": null, "min_ndim": null, "axes": {}}, "shared_object_id": 523}}2
root.layer_with_weights-96"_tf_keras_layer*Ï{"name": "predictions", "trainable": true, "expects_training_arg": false, "dtype": "float32", "batch_input_shape": null, "stateful": false, "must_restore_from_config": false, "class_name": "Dense", "config": {"name": "predictions", "trainable": true, "dtype": "float32", "units": 11, "activation": "softmax", "use_bias": true, "kernel_initializer": {"class_name": "GlorotUniform", "config": {"seed": null}, "shared_object_id": 430}, "bias_initializer": {"class_name": "Zeros", "config": {}, "shared_object_id": 431}, "kernel_regularizer": null, "bias_regularizer": null, "activity_regularizer": null, "kernel_constraint": null, "bias_constraint": null}, "inbound_nodes": [[["avg_pool", 0, 0, {}]]], "shared_object_id": 432, "input_spec": {"class_name": "InputSpec", "config": {"dtype": null, "shape": null, "ndim": null, "max_ndim": null, "min_ndim": 2, "axes": {"-1": 768}}, "shared_object_id": 524}, "build_input_shape": {"class_name": "TensorShape", "items": [null, 768]}}2
»root.keras_api.metrics.0"_tf_keras_metric*{"class_name": "Mean", "name": "loss", "dtype": "float32", "config": {"name": "loss", "dtype": "float32"}, "shared_object_id": 525}2
îroot.keras_api.metrics.1"_tf_keras_metric*¶{"class_name": "MeanMetricWrapper", "name": "accuracy", "dtype": "float32", "config": {"name": "accuracy", "dtype": "float32", "fn": "categorical_accuracy"}, "shared_object_id": 526}2